#LyX file created by  tex2lyx 0.1.2
\lyxformat 245
\begin_document
\begin_header
\textclass book
\begin_preamble
%% LyX 1.5.1 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.






\usepackage{float}

\usepackage{textcomp}

\usepackage{color}


\IfFileExists{url.sty}{\usepackage{url}
}
                      {\newcommand{\url}{\texttt}}

\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Bold symbol macro for standard LaTeX users


%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.4 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.






\usepackage{float}


\usepackage{textcomp}


\usepackage{url}




\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Bold symbol macro for standard LaTeX users


%% Because html converters don't know tabularnewline


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
%% LyX 1.5.4 created this file.  For more info, see http://www.lyx.org/.
%% Do not edit unless you really know what you are doing.



\usepackage{geometry}



\geometry{verbose,letterpaper,tmargin=1in,bmargin=1in,lmargin=1in,rmargin=1in}



\usepackage{float}



\usepackage{textcomp}



\usepackage{url}





\makeatletter

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% LyX specific LaTeX commands.
%% Bold symbol macro for standard LaTeX users



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% Textclass specific LaTeX commands.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%% User specified LaTeX commands.
\usepackage{hyperref}




\let\myUrl\url
\renewcommand{\url}[1]{(\myUrl{#1})}


\makeatother


\makeatother


\makeatother


\end_preamble
\language english
\inputencoding latin9
\fontscheme default
\graphics default
\paperfontsize default
\spacing single
\papersize default
\use_geometry false
\use_amsmath 0
\cite_engine basic
\use_bibtopic false
\paperorientation portrait
\secnumdepth 3
\tocdepth 3
\paragraph_separation indent
\defskip medskip
\quotes_language english
\papercolumns 1
\papersides 2
\paperpagestyle headings
\tracking_changes false
\output_changes false
\end_header

\begin_body

\begin_layout Standard
\noindent
\align center


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
thispagestyle{empty}
\end_layout

\end_inset


\begin_inset Float figure
placement H
wide false
sideways false
status open


\begin_layout Standard

 
\begin_inset Graphics 
	filename images/conman_cover.pdf
	width 75page%

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Title

ConMan
\end_layout

\begin_layout Author

© California Institute of Technology
\newline
 Scott King
\newline
 Version 2.0
\end_layout

\begin_layout Date


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
today
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset LatexCommand \tableofcontents

\end_inset


\end_layout

\begin_layout Standard


\begin_inset FloatList figure

\end_inset


\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
raggedbottom
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\newpage

\end_layout

\begin_layout Chapter

Preface
\end_layout

\begin_layout Section

Abstract
\end_layout

\begin_layout Standard

This manual serves as a user guide for ConMan, a vectorized finite element program for the solution of the equations of incompressible, infinite-Prandtl number convection in two dimensions originally written by Arthur Raefsky, Scott King, and Brad Hager. ConMan is a public domain program and is distributed free of charge to anyone who wishes to use it and may be freely copied and modified. ConMan is written in Standard Fortran 77 with cray pointers and runs on most Unix systems with many Fortran compilers (see Section 3.4 
\series bold
[TODO -- 3.4 is placeholder section. Is this correct? Need label to put cross ref here]
\series default
). Porting it to other systems should be straightforward. As with anything free it comes with no guarantees, but it has been benchmarked against other existing codes (see Chapter 
\begin_inset LatexCommand \ref{cha:The-Benchmark-Cases}

\end_inset

). The authors would appreciate any information regarding bugs or potential problems but make no promises regarding the timeliness of changes or fixes; see Section 
\begin_inset LatexCommand \ref{sec:Support}

\end_inset

 for instructions on how to report problems.
\end_layout

\begin_layout Section

Introduction
\end_layout

\begin_layout Standard

This manual contains all of the necessary information for setting up input and running ConMan. It assumes some familiarity with the finite element method and Fortran. An excellent reference book for more detail on the finite element method is 
\emph on
The Finite Element Method
\emph default
 by T.J.R. Hughes. All of the data structures and bookkeeping arrays in ConMan follow the conventions in Hughes so for the person who wishes to make extensive use of ConMan, this book is a worthwhile investment.
\end_layout

\begin_layout Standard

This manual is broken up into several parts: it begins with a brief introduction to the finite element method and the notation that is used throughout the manual and ConMan. There is a discussion of the equations solved and the material properties including how and where to modify the code. There is also discussion of some key points concerning the implementation and finally a description of all the input variables. Within this document the following convention will be followed: subroutine names from ConMan will be given in 
\series bold
bold
\series default
 type, variables from ConMan will be given in 
\emph on
italicized
\emph default
 type.
\end_layout

\begin_layout Section

Citation
\end_layout

\begin_layout Standard

Computational Infrastructure for Geodynamics (CIG) is making this source code available to you in the hope that the software will enhance your research in geophysics. The ConMan code was donated to CIG in June 2008. A number of individuals have contributed a significant portion of their careers toward the development of ConMan. It is essential that you recognize these individuals in the normal scientific practice by making appropriate acknowledgements.
\end_layout

\begin_layout Standard

The code is based on the method described in
\end_layout

\begin_layout Itemize

King, S.D., A. Raefsky, and B.H. Hager (1990), ConMan: Vectorizing a finite element code for incompressible two-dimensional convection in the Earth's mantle, 
\emph on
Phys. Earth Planet. Int., 59, 
\emph default
195-208. 
\end_layout

\begin_layout Standard

The code was originally developed by Scott King, Arthur Raefsky and Brad Hager, although many people have contributed improvements to ConMan over the past 15 years. The ConMan team requests that in your oral presentations and in your papers that you indicate your use of this code and acknowledge the author of the code and CIG 
\begin_inset LatexCommand \url{geodynamics.org}

\end_inset

.
\end_layout

\begin_layout Section

Support
\end_layout

\begin_layout Standard

ConMan maintenance is supported by a grant from the National Science Foundation to CIG, managed by the California Institute of Technology, under Grant No. EAR-0406751.
\end_layout

\begin_layout Standard

Any opinions, findings, and conclusions or recommendations expressed in this material are those of the author and do not necessarily reflect the views of the National Science Foundation.
\end_layout

\begin_layout Chapter

Computational Approach and Governing Equations
\end_layout

\begin_layout Section

The Finite Element Method
\end_layout

\begin_layout Standard

This section closely follows Hughes (
\emph on
The Finite Element Method
\emph default
) Chapter\InsetSpace ~
1, sections 1-4. There are two ways we can write the equation, the strong and the weak form. More readers are probably more familiar with the strong form, and less familiar with the weak form. The finite element method is cast in the weak form. In elasticity, for example, the weak form comes from a variational principal, such as the principal of virtual displacements in elasticity. For viscous flow, there is also a variational form, but we will not discuss that here.
\end_layout

\begin_layout Standard

In general, the finite element method takes a differential equation (strong form) and transforms it into an integral equation (weak form).
\end_layout

\begin_layout Subsection

The Strong Form
\end_layout

\begin_layout Standard

For example, the strong form of this simple equation is stated as follows:
\end_layout

\begin_layout Standard

Given 
\begin_inset Formula $f\left(x\right):\left[0,1\right]$
\end_inset

 
\begin_inset Formula $\rightarrow\Re$
\end_inset

 and constants 
\emph on
g
\emph default
 and 
\emph on
h
\emph default
, find 
\begin_inset Formula $u:\left[0,1\right]\rightarrow\Re$
\end_inset

, such that
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
u,_{xx}\left(x\right)+f\left(x\right)=0\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
u\left(1\right)=g\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
-u,_{x}\left(0\right)=h\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

This choice of initial conditions allows us to examine both kinds of boundary conditions. The solution is trivial, but that does not matter. For completeness, it is 
\begin_inset Formula \begin{equation}
u(x)=g+(1-x)h+\int_{x}^{1}\left(\int_{0}^{y}f(z)dz\right)dy\end{equation}
\end_inset


\end_layout

\begin_layout Subsection

The Weak Form
\end_layout

\begin_layout Standard

The weak form of the corresponding boundary value problem is stated:
\end_layout

\begin_layout Standard

Given 
\emph on
f
\emph default
, 
\emph on
g
\emph default
 and 
\emph on
h
\emph default
, as before. Find 
\begin_inset Formula $u\left(x\right)\epsilon\mathcal{L}$
\end_inset

 such that for all 
\begin_inset Formula $w\left(x\right)\epsilon\nu$
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\intop_{0}^{1}w,_{x}\left(x\right)u,_{x}\left(x\right)=\intop_{0}^{1}w\left(x\right)f\left(x\right)dx+w\left(0\right)h\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent


\begin_inset Formula $\nu$
\end_inset

 is the set of weighting functions defined by
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\nu=\left\{ w\left(x\right)|w\left(x\right)\epsilon H^{1},\, w\left(1\right)=0\right\} \label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

and 
\begin_inset Formula $\mathcal{L}$
\end_inset

 is a set of trial solutions defined by
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\mathcal{L=\left\{ \mathrm{\mathit{u\left(x\right)|u\left(x\right)}\epsilon H^{1},\,\mathit{u}\left(1\right)=\mathit{g}}\right\} }\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent


\begin_inset Formula $H^{1}$
\end_inset

 is the set of all functions whose first derivatives are square integrable on [0, 1]. The integral equation is then solved by integrating over each element in the domain and adding the result. The result is a large sparse matrix equation of the form
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\left[K\right]x=b\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

where 
\emph on
[K]
\emph default
 is referred to as the element stiffness matrix. There will be more to say about the implementation in Section 
\begin_inset LatexCommand \ref{cha:Input-Guide}

\end_inset

.
\end_layout

\begin_layout Subsection

Galerkin's Approximation
\end_layout

\begin_layout Standard

Now we have a start on the finite element method. We continue to follow Hughes; however, his notation becomes quite difficult to keep up with. Now, let's begin to think about putting a solution on the computer. Because we will have a finite approximation, related to how fine we space our grid, our solution will only approximate the real solution. Following Hughes' notation, the solution on the grid will be denoted as 
\begin_inset Formula $u^{h}$
\end_inset

 where 
\begin_inset Formula $h$
\end_inset

 is some measure of the spacing at the grid. Then, 
\begin_inset Formula \begin{equation}
\int_{0}^{1}w^{h},_{x}u^{h},_{x}dx~=~\int_{0}^{1}w^{h}\, f^{h}\, dx+w^{h}(0)h.\label{eq:weak}\end{equation}
\end_inset

 approximates our exact solution 
\begin_inset Formula $u$
\end_inset

.
\end_layout

\begin_layout Standard

On a computer, we don't have a continuous solution. We have a solution at discrete points. We need to approximate the solution between the points (in order to integrate over the function). We will do this with 
\series bold
shape functions
\series default
, as they are usually called in the finite element language. Hughes uses 
\begin_inset Formula $N_{A}A=1,2,\cdots,n$
\end_inset

 to denote the shape functions. You can also think of these as basis functions or interpolation functions. We require 
\begin_inset Formula $N_{A}(1)=0,A=1,2,\cdots,n$
\end_inset

. In order to specify our boundary condition, we need another shape function which has the property 
\begin_inset Formula \begin{equation}
N_{n+1}(1)=1.\end{equation}
\end_inset

 Then, 
\begin_inset Formula $g^{h}$
\end_inset

 is given by, 
\begin_inset Formula \begin{equation}
g^{h}=gN_{n+1}\end{equation}
\end_inset

 and thus, 
\begin_inset Formula \begin{equation}
g^{h}(1)=g.\end{equation}
\end_inset

 With these definitions, we can write our solution 
\begin_inset Formula $u^{h}$
\end_inset

 as 
\begin_inset Formula \begin{equation}
u^{h}=\sum_{A=1}^{n}\, d_{A}\, N_{A}+gN_{n+1}\end{equation}
\end_inset

 where the 
\begin_inset Formula $d_{A}$
\end_inset

's are unknown constants to be solved for.
\end_layout

\begin_layout Standard

In the next section we will make the shape functions more concrete. It is useful to see how general this is, because in principle there is a great deal of flexibility in how we choose the shape functions.
\end_layout

\begin_layout Standard

We have not said anything more about this function 
\begin_inset Formula $w^{h}$
\end_inset

 and how we are going to choose it. If our shape functions form a basis set for the grid, then we can represent 
\series bold
any
\series default
 function as a sum of the basis functions times some arbitrary coefficients 
\begin_inset Formula $c_{i}$
\end_inset

, 
\begin_inset Formula \begin{equation}
w^{h}=\sum_{A=1}^{n}\, c_{A}\, N_{A}=c_{1}\, N_{1}~+~c_{2}\, N_{2}~+~\cdots~+~c_{n}\, N_{n}\label{eq:whapprox}\end{equation}
\end_inset

 If you don't remember this part of your mathematics background think of Fourier series. Any function one-dimensional function can be represented as an infinite series of sines and cosines times some unique set of coefficients. The shape functions form a similar kind of basis set.
\end_layout

\begin_layout Standard

Notice that because we required that 
\begin_inset Formula $N_{A}(1)=0,A=1,2,\cdots,n$
\end_inset

, Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:whapprox}

\end_inset

 satisfies the requirement that 
\begin_inset Formula $w^{h}(1)=0$
\end_inset

, as necessary.
\end_layout

\begin_layout Standard

Using our definitions of the 
\begin_inset Formula $w^{h}$
\end_inset

's and our approximation for 
\begin_inset Formula $u^{h}$
\end_inset

, we can get the messy expression for Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:weak}

\end_inset

 
\begin_inset Formula \[
\int_{0}^{1}\left(\frac{\partial}{\partial x}\left(\sum_{A=1}^{n}\, c_{A}\, N_{A}\right)\frac{\partial}{\partial x}\left(\sum_{B=1}^{n}\, d_{B}\, N_{B}+gN_{n+1}\right)\right)dx~=~\]
\end_inset

 
\begin_inset Formula \begin{equation}
\int_{0}^{1}\sum_{A=1}^{n}\, c_{A}\, N_{A}\, f^{h}\, dx+\sum_{A=1}^{n}\, c_{A}N_{A}(0)h.\end{equation}
\end_inset

 By rearranging, we can write 
\begin_inset Formula \begin{equation}
\sum_{A=1}^{n}G_{A}c_{A}=0\end{equation}
\end_inset

 where 
\begin_inset Formula \[
G_{A}~=~\int_{0}^{1}\left(\frac{\partial N_{A}}{\partial x}\right)\left(\sum_{B=1}^{n}\, d_{B}\,\frac{\partial N_{B}}{\partial x}\right)dx\]
\end_inset

 
\begin_inset Formula \begin{equation}
-\int_{0}^{1}N_{A}\, f^{h}\, dx-N_{A}(0)h+\int_{0}^{1}\frac{\partial N_{A}}{\partial x}\frac{\partial N_{n+1}}{\partial x}\, g\, dx\end{equation}
\end_inset

 Now I use the fact that the shape functions are basis functions, so 
\begin_inset Formula $N_{A}\times N_{B}$
\end_inset

 is zero except when 
\begin_inset Formula $A=B$
\end_inset

. We could equally well use the fact that the 
\begin_inset Formula $c_{A}$
\end_inset

's are arbitrary. Both of these force us to conclude that each 
\begin_inset Formula $G_{A}$
\end_inset

 must be identically zero and we get 
\begin_inset Formula \[
\sum_{B=1}^{n}\,\left(\int_{0}^{1}\frac{\partial N_{A}}{\partial x}\frac{\partial N_{B}}{\partial x}\, dx\right)\, d_{B}=\]
\end_inset

 
\begin_inset Formula \begin{equation}
\int_{0}^{1}N_{A}\, f^{h}\, dx+N_{A}(0)h-g\,\int_{0}^{1}\frac{\partial N_{A}}{\partial x}\frac{\partial N_{n+1}}{\partial x}\, dx\label{eq:feform}\end{equation}
\end_inset

 Everything in Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:feform}

\end_inset

 is known except the 
\begin_inset Formula $d_{B}$
\end_inset

's. This constitutes a system of 
\begin_inset Formula $n$
\end_inset

 equations and 
\begin_inset Formula $n$
\end_inset

 unknowns. We can think of the left-hand side as a matrix, 
\begin_inset Formula $K_{AB}$
\end_inset

 whose entries are 
\begin_inset Formula \begin{equation}
\int_{0}^{1}\frac{\partial N_{A}}{\partial x}\frac{\partial N_{B}}{\partial x}\, dx\label{eq:Kelements}\end{equation}
\end_inset

 We can write 
\begin_inset Formula \begin{equation}
\sum_{B=1}^{n}\, K_{AB}d_{B}=F_{A},~~~~~A=1,2,\cdots,n\end{equation}
\end_inset

 or as a matrix equation 
\begin_inset Formula \begin{equation}
\left[K\right]\,\{d\}=\{f\}\end{equation}
\end_inset

 where 
\begin_inset Formula \begin{equation}
[k]=\left[\begin{array}{cccc}
K_{11} & K_{12} & \cdots & K_{1n}\\
K_{21} & K_{22} & \cdots & K_{2n}\\
\vdots & \vdots &  & \vdots\\
K_{n1} & K_{n2} & \cdots & K_{nn}\end{array}\right]\label{Kmatrix}\end{equation}
\end_inset

 By tradition, 
\begin_inset Formula $\left[K\right]$
\end_inset

 is the stiffness matrix, 
\begin_inset Formula $\{f\}$
\end_inset

 is the force vector, and 
\begin_inset Formula $\{d\}$
\end_inset

 is the displacement vector. When the problem under consideration pertains to a mechanical system, this makes the most sense, but even in heat conduction problems, or fluid flow problems, the terminology is still (often) retained.
\end_layout

\begin_layout Subsection

Shape Functions
\end_layout

\begin_layout Standard

At this point, we narrow the focus to deal with specifically the elements in ConMan. It is possible to think very general shape functions, but in practice, people use triangles or quadralaterals (in 2D). In terms of the level of approximation, there are also a lot of possibilities. We will stick to the simplest form, bilinear elements, but you should be aware that higher order elements (biquadratic or bicubic spline elements) are also popular with some people. This section is condensing a lot of very useful material from Chapter 3 of Hughes' book into a short overview. If you want to see more complete derivations, proofs of convergence, etc., of how to go about using higher order elements, look at Hughes book, Chapter 3.
\end_layout

\begin_layout Standard

Let's start by thinking of a rectangle that is 2a by 2b in length centered at (0,0). There are two properties we would like the shape functions to have 
\begin_inset Formula \begin{eqnarray}
\sum_{A=1}^{4}N_{A}(X,Y) & = & 1\label{eq:normalize}\\
\sum_{A=1}^{4}N_{A}(X,Y)\, X_{A} & = & X\label{eq:interpx}\\
\sum_{A=1}^{4}N_{A}(X,Y)\, Y_{A} & = & Y\label{eq:interpy}\end{eqnarray}
\end_inset

 Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:normalize}

\end_inset

 says that they are normalized, so that they sum to one (everywhere on X,Y). Equations\InsetSpace ~

\begin_inset LatexCommand \ref{eq:interpx}

\end_inset

 and\InsetSpace ~

\begin_inset LatexCommand \ref{eq:interpy}

\end_inset

 state that the shape functions are also interpolation functions. Without doing a lot of derivation, I will claim that for the rectangle described above, 
\begin_inset Formula \begin{eqnarray}
N_{1} & = & \frac{(a-x)(b-y)}{4ab}\\
N_{2} & = & \frac{(a+x)(b-y)}{4ab}\\
N_{3} & = & \frac{(a+x)(b+y)}{4ab}\\
N_{4} & = & \frac{(a-x)(b+y)}{4ab}\end{eqnarray}
\end_inset

 these shape functions satisfy the conditions in Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:normalize}

\end_inset

 and Equations \InsetSpace ~

\begin_inset LatexCommand \ref{eq:interpx}

\end_inset

 and\InsetSpace ~

\begin_inset LatexCommand \ref{eq:interpy}

\end_inset

. A good exercise would be to show this is true. A visual representation of these shape functions is shown in Figure
\begin_inset LatexCommand \ref{fig:The-bilinear-shape}

\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:The-bilinear-shape}

\end_inset

The bilinear shape function for a single element (top) and the four elements whose shape functions combine to form the global shape function for node A (bottom). Figure taken from Hughes, Section 3.2.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Graphics 
	filename images/conman-fig2.eps
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In ConMan we further choose to normalize this by setting 
\begin_inset Formula $a=1$
\end_inset

 and 
\begin_inset Formula $b=1$
\end_inset

. This choice gives us an element whose area is 1, which is a convenient way to think about things. (This is because we left the factor of 1/4 in the denominator). In my code, to make one less set of computations, I in effect set 
\begin_inset Formula $a=0.5$
\end_inset

 and 
\begin_inset Formula $b=0.5$
\end_inset

 so that the denominator goes to 1.
\end_layout

\begin_layout Standard

Notice it is pretty easy to take derivatives of these shape functions 
\begin_inset Formula \begin{eqnarray}
N_{1,x} & = & \frac{-(1-y)}{4}\\
N_{2,x} & = & \frac{(1-y)}{4}\\
N_{3,x} & = & \frac{(1+y)}{4}\\
N_{4,x} & = & \frac{-(1+y)}{4}\end{eqnarray}
\end_inset

 
\begin_inset Formula \begin{eqnarray}
N_{1,y} & = & \frac{-(1-x)}{4}\\
N_{2,y} & = & \frac{-(1+x)}{4}\\
N_{3,y} & = & \frac{(1+x)}{4}\\
N_{4,y} & = & \frac{(1-x)}{4}\end{eqnarray}
\end_inset

 What do we do if we want to solve a problem on a domain that is not convenient to split into a grid of 1 by 1 unit elements? We use an important principle of mathematics, the Jacobian of the transformation 
\begin_inset Formula \begin{equation}
K_{11}~=~\int_{A}^{B}N_{1,x}N_{1,x}\, dx~=~\int_{0}^{1}N_{1,x}N_{1,x}\, Jdx\end{equation}
\end_inset

 where 
\begin_inset Formula $J$
\end_inset

 is the Jacobian of the transformation. This is a very powerful point. When we are thinking of solving a regular Cartesian domain, this just corresponds to a stretching or a shrinking (notice we set 
\begin_inset Formula $a=b=1$
\end_inset

 above (see Figure 
\begin_inset LatexCommand \ref{fig:Figure-1}

\end_inset

).
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:Figure-1}

\end_inset

The mapping between the global domain (right) and the parent element domain (left) using the shape functions. Figure taken from Hughes, Section 3.2.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Graphics 
	filename images/conman-fig1.eps
	scale 45

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

However, if we are thinking about a cylindrical geometry, for example, we can use the Jacobian of the transformation between the geometries. Let's look at two examples:
\end_layout

\begin_layout Standard

Converting an element 0.05 by 0.10 centered at (0.1,0.2) to the `parent element' centered at (0,0). Hughes also uses 
\begin_inset Formula $\xi,\eta$
\end_inset

 for the 
\begin_inset Formula $X,Y$
\end_inset

 coordinate pair in the `parent element.' So we could write 
\begin_inset Formula \begin{eqnarray}
x & = & 0.1+{0.05}\xi+0.0\eta\\
y & = & 0.2+{0.0}\xi+{0.10}\eta\end{eqnarray}
\end_inset

 or in matrix form we could write 
\begin_inset Formula \begin{equation}\label{eq:transform}
\left\{ \begin{array}{c}
x\\
y\end{array}\right\} =\left[\begin{array}{cc}
0.05 & 0.0\\
0.0 & 0.10\end{array}\right]\left\{ \begin{array}{c}
\xi\\
\eta\end{array}\right\} +\left\{ \begin{array}{c}
0.1\\
0.2\end{array}\right\} \end{equation}
\end_inset

 If the transformation was from an arbitratry shaped quadrilateral to the parent element, then the off diagonal terms in the mateix in equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:transform}

\end_inset

 will not be zero. It is easy enough to show that 
\begin_inset Formula \begin{equation}
\int_{x_{1}}^{x_{2}}\int_{y_{1}}^{y_{2}}f(x,y)\, dx\, dy=\int_{-1}^{1}\int_{-1}^{1}f(\xi,\eta)\,{\rm det}[J]\, d\xi\, d\eta\end{equation}
\end_inset

 where 
\begin_inset Formula $[J]$
\end_inset

 is the Jacobian of the transformation. It turns out, and it is also easy to show, that 
\begin_inset Formula ${\rm det}[J]$
\end_inset

 is the ratio of the areas when going from one rectangle to another (in fact any Cartesian to Cartesian transformation).
\end_layout

\begin_layout Standard


\series bold
Advanced Topic:
\series default
 Now suppose we want to map a cylindrical domain to our `parent element.' We can use the same principle in this case: 
\begin_inset Formula \begin{eqnarray}
x & = & r\cos\theta=\cos\theta\,\xi-r\sin\theta\,\eta\\
y & = & r\sin\theta=\sin\theta\,\xi+r\cos\theta\,\eta\end{eqnarray}
\end_inset

 so 
\begin_inset Formula \begin{equation}
{\rm det}[J_{geometry}]~=~r\cos^{2}\theta+r\sin^{2}\theta=r.\end{equation}
\end_inset

 of we would get 
\begin_inset Formula \begin{equation}
\int_{r_{1}}^{r_{2}}\int_{\theta_{1}}^{\theta_{2}}f(r\cos\theta,r\sin\theta)\, r\, dr\, d\theta=\int_{-1}^{1}\int_{-1}^{1}f(\xi,\eta)\,{\rm det}[J_{area}]\, d\xi\, d\eta\end{equation}
\end_inset


\end_layout

\begin_layout Subsubsection

Gauss Quadrature
\end_layout

\begin_layout Standard

An amazing fact, that makes the idea of finite elements easy and powerful, is Gauss Quadrature. Gauss Quadrature is a way to turn an integral into a summation. Let's begin with a 1D example, 
\begin_inset Formula $f(x)=c$
\end_inset

 
\begin_inset Formula \begin{equation}
\int_{-1}^{1}c\, dx=cx|_{-1}^{1}=2c\end{equation}
\end_inset

 Gauss noted that for any linear function 
\begin_inset Formula \begin{equation}
\int_{-1}^{1}f(x)\, dx=2.0\times f(0)=2c\end{equation}
\end_inset

 For a linear function, 
\begin_inset Formula $f(x)=ax+b$
\end_inset

 
\begin_inset Formula \begin{equation}
\int_{-1}^{1}f(x)\, dx=f(\frac{-1}{\sqrt{3}})+f(\frac{-1}{\sqrt{3}})\end{equation}
\end_inset

 The direct way, 
\begin_inset Formula \begin{equation}
\int_{-1}^{1}(ax+b)\, dx=(\frac{ax^{2}}{2}+bx)|_{-1}^{1}=\frac{a}{2}+b-(\frac{a}{2}-b)=2b\end{equation}
\end_inset

 Gauss' way 
\begin_inset Formula \begin{equation}
\int_{-1}^{1}(ax+b)\, dx=a\frac{-1}{\sqrt{3}}+b+a\frac{1}{\sqrt{3}}+b=2b\end{equation}
\end_inset

 It turns out that 
\begin_inset Formula $\frac{-1}{\sqrt{3}},\frac{1}{\sqrt{3}}$
\end_inset

 are exact for a linear equation, but from what I showed, so would any 
\begin_inset Formula $-x,x$
\end_inset

 combination, but what Gauss showed was more powerful, that if the function is of higher order, the 
\begin_inset Formula $\frac{-1}{\sqrt{3}},\frac{1}{\sqrt{3}}$
\end_inset

 choice is the best approximation you can make with only two terms. If we go to three terms, the choice would be 
\begin_inset Formula $-\sqrt{\frac{3}{5}},0,\sqrt{\frac{3}{5}}$
\end_inset

.
\end_layout

\begin_layout Standard

To integrate a 2D Cartesian region, like our parent element, it turns out that 2 by 2 quadrature, or the four points 
\begin_inset Formula \begin{eqnarray}
\xi=\frac{-1}{\sqrt{3}} & ~~~ & \eta=\frac{-1}{\sqrt{3}}\\
\xi=\frac{1}{\sqrt{3}} & ~~~ & \eta=\frac{-1}{\sqrt{3}}\\
\xi=\frac{1}{\sqrt{3}} & ~~~ & \eta=\frac{1}{\sqrt{3}}\\
\xi=\frac{-1}{\sqrt{3}} & ~~~ & \eta=\frac{1}{\sqrt{3}}\end{eqnarray}
\end_inset

 are sufficient to exactly integrate our bilinear shape functions over the 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

-1,-1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 to 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

1,1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 domain.
\end_layout

\begin_layout Standard

At this point, it would be worth talking about the code ConMan for a minute. The shape functions are generated in ConMan in the routine 
\series bold
genshp
\series default
 for GENerate SHape functions Parent domain. If you look at the routine you will find the first part of it is pretty easy to follow from the discussion above. Some of the second part is a little tricky in the details, but generally it is also pretty easy to follow.
\end_layout

\begin_layout Standard

The subroutine 
\series bold
genshg
\series default
 deals with the global shape functions (i.e., deals with the geometry and size). Originally, we called this routine once and stored all the shape functions. As problem sizes have grown, this took a lot of storage, so now we call it on the fly for each element when needed. It is computationally more expensive but cuts the storage requirement. This strategy will also be necessary for a Lagrangian formulation or adaptive gridding.
\end_layout

\begin_layout Standard

There are two domains to keep in mind when thinking about the finite element method: the global domain and the parent element domain (Figure 
\begin_inset LatexCommand \ref{fig:Figure-1}

\end_inset

). All calculations are done in the parent element domain and the results are assembled into the global equations. This means all calculations can be done for a single parent element. Elements of different sizes or shapes filling an irregular global domain geometry (i.e., non-rectangular) can be solved by the same program. The only difference between these elements is the Jacobian of the transformation between the input domain and the parent element domain, which is calculated in routine 
\series bold
genshg
\series default
.
\end_layout

\begin_layout Standard

For ConMan the choice was made to use bilinear quadrilaterals as the parent elements (Figure 
\begin_inset LatexCommand \ref{fig:The-bilinear-shape}

\end_inset

). Higher order elements (i.e., biquadratic or bicubic-spline) require more computational work per element. It has been our experience that using grid refinement, rather than using high-order elements, is the best strategy for an efficient, accurate code for incompressible, advection-diffusion problems.
\end_layout

\begin_layout Standard

Because of the changing between domains, it is necessary to define several bookkeeping arrays to identify nodes and elements in each of the domains. It is worth noting that the numbering of local elements always begins with 1 in the lower left-hand corner. There is no special reason; you just have to choose a convention.
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

id
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 transforms global nodes to equation numbers (Figure 
\begin_inset LatexCommand \ref{fig:Example-relationship-between}

\end_inset

). 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ien
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 transforms element local node numbers to global node numbers (Figure 
\begin_inset LatexCommand \ref{fig:4-Example-relationship-between}

\end_inset

). 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

lm
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 transforms element local node numbers to global equation numbers. 
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:Example-relationship-between}

\end_inset

 Example relationship between global nodes and equation numbers for a 2 degree of freedom problem using the id array. An equation number of zero denotes a boundary condition. Figure taken from Hughes, Section 3.2.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Graphics 
	filename images/conman-fig3.eps
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

With these, the code is able to go back and forth between the parent element domain and the global domain. Global node numbering is specified by the user, and equation numbers are assigned by the code to denote the row in the stiffness matrix corresponding to the degree(s) of freedom for that node. One global node may have more than one equation number (since there may be more than one degree of freedom per node). Boundary conditions are specified with a zero equation number. Since it is a sparse matrix, it is desirable to permute the stiffness matrix for computational efficiency. These arrays spare the user from dealing with the transformations, while making the code efficient.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:4-Example-relationship-between}

\end_inset

Example relationship between global node numbers and local element numbers using the ien array. Local nodes are numbered counterclockwise from the bottom left-hand corner. Figure taken from Hughes, Section 3.2.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Graphics 
	filename images/conman-fig4.eps
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

In the code, the data structures for these two arrays are
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

id
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 ( degree-of-freedom , global-node-number ) = equation-number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ien
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 ( local-node-number, element-number ) = global-node-number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

lm
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 ( degree-of-freedom, local-node-number, element-number ) = global-equation-number 
\end_layout

\begin_layout Subsection

The Element Point of View
\end_layout

\begin_layout Standard

Transforming between the element and global points of view is done with the data structure called the IEN array for Element to Node transformation. The IEN array takes an element number and a local node number, and its value is the global node number. It is easiest to look at some examples:
\end_layout

\begin_layout Standard

Consider a 3-element by 3-element grid. I will number my elements and nodes starting in the lower left hand corner, and the node and element numbers will increase linearly in the vertical direction.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{verbatim}
\end_layout

\end_inset

 For element 3: ien (3, 1) = 3 ien (3, 2) = 7 ien (3, 3) = 8 ien (3, 4) = 4
\end_layout

\begin_layout Standard

For element 5: ien (5, 1) = 6 ien (5, 2) = 10 ien (5, 3) = 11 ien (5, 4) = 7 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

There are three kinds of operations we might want to use. The first is taking the values of some function (coordinates, velocities, temperatures, stresses, etc.) defined on the global grid and getting the values for a single element, which is called a 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 gather
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 operation. The next is taking values in an element and spreading them out to the global array, which is called a 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 scatter
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 operation. The third operation is to take the value at a local node and add it to the global value for that node, an 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 assembly
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 step.
\end_layout

\begin_layout Standard

All three operations -- gather, scatter, and assemble -- are done by the routine 
\series bold
local
\series default
. Because it is called by the 
\series bold
genshp
\series default
 routine above, it is a good example to study.
\end_layout

\begin_layout Subsection

Equations
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{eqnarray}
\tau_{ij,j}+f_{i} & = & 0\label{eq:motion}\\
u_{i,i} & = & 0\end{eqnarray}
\end_inset

 where 
\begin_inset Formula \begin{equation}
\tau_{ij}=-p\delta_{ij}+2\mu u_{(i,j)}\label{eq:constit}\end{equation}
\end_inset

 where 
\begin_inset Formula \begin{equation}
u_{(i,j)}=(u_{i,j}+u_{j,i})/2\end{equation}
\end_inset

 We replace Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:constit}

\end_inset

 with the following relationships 
\begin_inset Formula \begin{eqnarray}
\tau_{ij}=-p^{\lambda}\delta_{ij}+2\mu u_{(i,j)}\label{eq:constit-lam}\\
0=u_{i,i}+p^{\lambda}/\lambda.\label{eq:constit-lam2}\end{eqnarray}
\end_inset

 As 
\begin_inset Formula $\lambda$
\end_inset

 approaches infinity, these relations approach the incompressible solution. Also, as 
\begin_inset Formula $\lambda$
\end_inset

 approaches infinity, 
\begin_inset Formula $p^{\lambda}$
\end_inset

 approaches the hydrostatic pressure in the incompressible case. In general, the hydrostatic pressure is 
\begin_inset Formula $-\tau_{ii}/3$
\end_inset

. Substituting Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:constit-lam2}

\end_inset

 into\InsetSpace ~

\begin_inset LatexCommand \ref{eq:constit-lam}

\end_inset

 we get 
\begin_inset Formula \begin{equation}
\tau_{ij}=\lambda u_{i,i}\delta_{ij}+2\mu u_{(i,j)}\label{eq:constit-lam-final}\end{equation}
\end_inset

 or 
\begin_inset Formula \begin{equation}
\tau_{ii}=3\lambda u_{i,i}+2\mu u_{i,i}\end{equation}
\end_inset

 or 
\begin_inset Formula \begin{equation}
\tau_{ii}/3=-p=(\lambda+2/3\mu)u_{i,i}\end{equation}
\end_inset

 but we also have 
\begin_inset Formula \begin{equation}
-p^{\lambda}=\lambda u_{i,i}\end{equation}
\end_inset

 from Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:constit-lam2}

\end_inset

. Clearly in the incompressible limit 
\begin_inset Formula $\lambda\gg\mu$
\end_inset

 then 
\begin_inset Formula $\lambda+2/3\mu\rightarrow\lambda$
\end_inset

 and 
\begin_inset Formula $p^{\lambda}\rightarrow p$
\end_inset

. Also note that the continuity equation is satisfied.
\end_layout

\begin_layout Standard

Now, substituting Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:constit-lam-final}

\end_inset

 into Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:motion}

\end_inset

 we have 
\begin_inset Formula \begin{equation}
\{\lambda u_{i,i}\delta_{ij}+2\mu u_{(i,j)}\},j+f_{i}=0\end{equation}
\end_inset

 At this point, it is probably easier to switch to differential notation. These will also specialize to 2D: 
\begin_inset Formula \begin{eqnarray}
\frac{\partial}{\partial x}\{\lambda(\frac{\partial u}{\partial x}+\frac{\partial v}{\partial z})+2\mu(\frac{\partial u}{\partial x}+\frac{\partial u}{\partial x})/2\}+\frac{\partial}{\partial z}\{2\mu(\frac{\partial v}{\partial x}+\frac{\partial u}{\partial z})/2\}+f_{x}=0\\
\frac{\partial}{\partial x}\{2\mu(\frac{\partial u}{\partial z}+\frac{\partial v}{\partial x})/2\}+\frac{\partial}{\partial z}\{\lambda(\frac{\partial u}{\partial x}+\frac{\partial v}{\partial z})+2\mu(\frac{\partial v}{\partial z}+\frac{\partial v}{\partial z})/2\}+f_{z}=0\end{eqnarray}
\end_inset


\end_layout

\begin_layout Standard

These are second order partial differential equations. Simplifying, we get 
\begin_inset Formula \begin{eqnarray}
\lambda(\frac{\partial^{2}u}{\partial x^{2}}+\frac{\partial^{2}v}{\partial x\partial z})+2\mu\frac{\partial^{2}u}{\partial x^{2}}+\mu(\frac{\partial^{2}u}{\partial z^{2}}+\frac{\partial^{2}v}{\partial z\partial x})+f_{x}=0\\
\lambda(\frac{\partial^{2}u}{\partial z\partial x}+\frac{\partial^{2}v}{\partial z^{2}})+\mu(\frac{\partial^{2}u}{\partial x\partial z}+\frac{\partial^{2}v}{\partial x^{2}})+2\mu\frac{\partial^{2}v}{\partial z^{2}}+f_{z}=0\end{eqnarray}
\end_inset


\end_layout

\begin_layout Standard

Now we use the same technique (approach) as we used in Possion's equation to turn the differential form into an integral form. You can either look at it as we find the variational form of the Stokes equation (which is what we are doing) or you can think of it as multiplying by a weighting function 
\begin_inset Formula $w$
\end_inset

 and integrating over the domain. Then using integration by parts to convert the second derivatives to first derivatives. This is done carefully by Hughes in 
\emph on
The Finite Element Method
\emph default
 on pages 197-200, but he has left out a number of intermediate steps. Nothing about this step is hard, just tedious. There is, however, a clever shortcut. If we return to the messy equations at the top of the page, multiply them by the weighting function 
\begin_inset Formula $w$
\end_inset

 and integrate over the domain, then we do not have to use integration by parts. To see this for yourself, simply take the equations directly above this paragraph, multiply by a weighting function 
\begin_inset Formula $w$
\end_inset

 and integrate over the 2D domain 
\begin_inset Formula $\Omega$
\end_inset

, then use integration by parts. You will find (after a little algebra)
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{eqnarray}
\int\int_{\Omega}\frac{\partial w}{\partial x}\{\lambda(\frac{\partial u}{\partial x}+\frac{\partial v}{\partial z})+2\mu\frac{\partial u}{\partial x}\}+\frac{\partial w}{\partial z}\{2\mu(\frac{\partial v}{\partial x}+\frac{\partial u}{\partial z})/2\}\, d\Omega+\nonumber \\
\int\int_{\Omega}f_{x}\, w\, d\Omega=b.c.~terms\\
\int\int_{\Omega}\frac{\partial w}{\partial x}\{2\mu(\frac{\partial u}{\partial z}+\frac{\partial v}{\partial x})/2\}+\frac{\partial w}{\partial z}\{\lambda(\frac{\partial u}{\partial x}+\frac{\partial v}{\partial z})+2\mu\frac{\partial v}{\partial z}\}\, d\Omega+\nonumber \\
\int\int_{\Omega}f_{z}\, w\, d\Omega=b.c.~terms\end{eqnarray}
\end_inset

 Note that we don't get something for nothing; this shortcut does not give us the boundary condition terms (velocity or flux). These would fall out of the integration by parts. Recall, 
\begin_inset Formula \begin{equation}
\int_{a}^{b}w\, dv=w\, v|_{a}^{b}-\int_{a}^{b}v\, dw\end{equation}
\end_inset

 where in our case 
\begin_inset Formula $w$
\end_inset

 is the weighting function and 
\begin_inset Formula $v$
\end_inset

 is the second derivative term. The first term gives us the flux (first derivative) boundary conditions. In the case of the momentum equations, that is the applied tractions (or stress boundary conditions).
\end_layout

\begin_layout Standard

Now we make use of Galerkin's approximation, or more simply, we use the same weighting functions as we use for interpolation function, i.e., the shape functions, N. So we substitute 
\begin_inset Formula \begin{eqnarray}
\frac{\partial w}{\partial x}=N_{x}\\
\frac{\partial w}{\partial z}=N_{z}\\
\frac{\partial u}{\partial x}=u\, N_{x}\\
\frac{\partial u}{\partial z}=u\, N_{z}\\
\frac{\partial v}{\partial x}=v\, N_{x}\\
\frac{\partial v}{\partial z}=v\, N_{z}\end{eqnarray}
\end_inset

 into our weak form equations. Although messy, that is straight-forward. 
\begin_inset Formula \begin{eqnarray}
\int\int_{\Omega}N_{x}\{\lambda(u\, N_{x}+v\, N_{z})+2\mu u\, N_{x}\}+N_{z}\{\mu(v\, N_{x}+u\, N_{z})\}\, d\Omega+\nonumber \\
\int\int_{\Omega}f_{x}\, w\, d\Omega=b.c.~terms\\
\int\int_{\Omega}N_{x}\{\mu(u\, N_{z}+v\, N_{x})\}+N_{z}\{\lambda(u\, N_{x}+v\, N_{z})+2\mu v\, N_{z}\}\, d\Omega+\nonumber \\
\int\int_{\Omega}f_{z}\, w\, d\Omega=b.c.~terms\end{eqnarray}
\end_inset


\end_layout

\begin_layout Standard

At this point, it is useful to separate the equations into a 
\begin_inset Formula $\lambda$
\end_inset

 part and a 
\begin_inset Formula $\mu$
\end_inset

 part. We can also write them as a 2D matrix equation 
\begin_inset Formula \begin{equation}
[K_{\lambda}]=\left[\begin{array}{cc}
N_{x}\lambda N_{x} & N_{x}\lambda N_{z}\\
N_{z}\lambda N_{x} & N_{z}\lambda N_{z}\end{array}\right]\label{eq:Klambda}\end{equation}
\end_inset

 and 
\begin_inset Formula \begin{equation}
[K_{\mu}]=\left[\begin{array}{cc}
N_{x}2\mu N_{x}+N_{z}\mu N_{z} & N_{z}\mu N_{x}\\
N_{x}\mu N_{z} & N_{z}2\mu N_{z}+N_{x}\mu N_{x}\end{array}\right].\label{eq:Kmu}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

Hughes makes use of an interesting and important observation. This observation will greatly simplify constructing the stiffness matrix for arbitrary coordinate systems. We can rewrite the stiffness matrices above in the following form: 
\begin_inset Formula \begin{equation}
[K_{\lambda}]+[K_{\mu}]=[B]^{T}[D][B]\label{eq:84}\end{equation}
\end_inset

 
\begin_inset Formula \begin{equation}
[D_{\lambda}]+[D_{\mu}]=[D]\end{equation}
\end_inset

 where 
\begin_inset Formula \begin{equation}
[D_{\mu}]=\mu\left[\begin{array}{ccc}
2 & 0 & 0\\
0 & 2 & 0\\
0 & 0 & 1\end{array}\right]\end{equation}
\end_inset

 and 
\begin_inset Formula \begin{equation}
[D_{\lambda}]=\lambda\left[\begin{array}{ccc}
1 & 1 & 0\\
1 & 1 & 0\\
0 & 0 & 0\end{array}\right]\end{equation}
\end_inset

 and 
\begin_inset Formula \begin{equation}
[B]=\left[\begin{array}{cc}
N_{x} & 0\\
0 & N_{z}\\
N_{z} & N_{x}\end{array}\right].\end{equation}
\end_inset


\end_layout

\begin_layout Standard

The momentum and energy equations form a simple coupled system of differential equations. We treat the incompressibility equation as a constraint on the momentum equation and enforce incompressibility in the solution of the momentum equation using a penalty formulation described below. Since the temperatures provide the buoyancy (body force) to drive the momentum equation and since there is no time-dependence in the momentum equation, the algorithm to solve the system is a simple one: Given an initial temperature field, calculate the resulting velocity field. Use the velocities to advect the temperatures for the next time step and solve for a new temperature field. If the time stepping for the temperature equation is stable, then this method is stable and converges as 
\begin_inset Formula $\Delta t\rightarrow0$
\end_inset

.
\end_layout

\begin_layout Standard

The element stiffness matrix (Equation\InsetSpace ~

\begin_inset LatexCommand \ref{eq:84}

\end_inset

) is made up of the two terms from the left hand side of the integral equation. The full element stiffness matrix for the quadralilateral element is an 8 by 8 matrix made up of 16 of the 2 by 2 matrices as shown in Figure\InsetSpace ~

\begin_inset LatexCommand \ref{fig:8-The-storage-for}

\end_inset

. Because of symmetry we only need to form and store the upper triangular part of the matrix. The integration is done using two by two gauss quadrature, which is exact when the elements are rectangular and bilinear shape functions are used. The 
\begin_inset Formula $\lambda$
\end_inset

 term is under-integrated (one point rule) to keep the large penalty value from effectively locking the element 
\begin_inset LatexCommand \cite{Malkus and Hughes 1978}

\end_inset

. The right-hand side is made up of three known parts, the body force term (
\begin_inset Formula $f_{i}$
\end_inset

), the applied tractions (
\begin_inset Formula $h_{i}$
\end_inset

) and the applied velocities (
\begin_inset Formula $g_{i}$
\end_inset

). The momentum equation is equivalent to an incompressible elastic problem, and the resulting stiffness matrix will always be positive definite 
\begin_inset LatexCommand \cite[p. 84-89]{Hughes 1987}

\end_inset

. This allows us to consider only the upper triangular part of the stiffness matrix and save both storage and operations using Cholesky factorization. More details of the method and a formal error analysis can be found in 
\begin_inset LatexCommand \cite{Hughes et al 1979}

\end_inset

.
\end_layout

\begin_layout Standard

The stiffness matrix is formed in routine 
\series bold
f_vstf
\series default
 and the right-hand side is formed in routine 
\series bold
f_tres
\series default
.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent 
\backslash
begin{center}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
begin{figure}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
caption{
\backslash
label{fig:5-The-element-stiffness}The element stiffness matrix for
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%the 2D Cartesian stokes equation. The 8 by 8 matrix is make up of
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%16 2 by 2 submatrices of the form shown below. The $
\backslash
lambda$ and
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%$
\backslash
mu$ parts are shown separately for clarity.}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
noindent 
\backslash
begin{centering}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
includegraphics[scale=0.4]{images/conman-fig5.eps} 
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
par
\backslash
end{centering}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
end{figure}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%
\backslash
par
\backslash
end{center}
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%I'm not sure if we need this too...
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:8-The-storage-for}

\end_inset

The storage for the stiffness matrix used in routine 
\series bold
f_vstf
\series default
.
\end_layout

\begin_layout Standard
\align center


\begin_inset Graphics 
	filename images/conman-fig8.eps
	scale 40

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard

The energy equation is an advection-diffusion equation. The formal statement is
\end_layout

\begin_layout Standard

Find 
\begin_inset Formula $T:\Omega\rightarrow R$
\end_inset

 such that
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\dot{T}+u_{i}T_{,i}=\kappa T_{,ii}+H\,\,\,\,\,\, on\,\,\Omega\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
T=b\,\,\,\,\,\, on\,\,\Gamma_{b}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
T_{,j}n_{j}=q\,\,\,\,\,\, on\,\,\Gamma_{q}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

where 
\begin_inset Formula $T$
\end_inset

 is the temperature, 
\begin_inset Formula $u_{i}$
\end_inset

 is the velocity, 
\begin_inset Formula $\kappa$
\end_inset

 is the thermal diffusivity and 
\begin_inset Formula $H$
\end_inset

 is the internal heat source. The weak form of the energy equation is given by
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\int_{\Omega}\left(w+p\right)\dot{T}d\Omega=-\int_{\Omega}\left(w+p\right)\left(u_{i}T_{,i}\right)d\Omega\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
-\kappa\int_{\Omega}w_{,i}T_{,i}d\Omega+\int_{\Gamma_{q}}wT_{,j}n_{j}d\Gamma_{q}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

where 
\begin_inset Formula $\dot{T}$
\end_inset

 is the time derivative of temperature, 
\begin_inset Formula $T_{,i}$
\end_inset

 is the gradient of temperature, 
\begin_inset Formula $w$
\end_inset

 is the standard weighting function and 
\begin_inset Formula $\left(w+p\right)$
\end_inset

 is the Petrov-Galerkin weighting function with p, the discontinuous streamline upwind part of the Petrov-Galerkin weighting function, given by
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
p=\tau u\nabla T=\tilde{k}\frac{u_{i}w_{,i}}{||u||^{2}}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

The energy equation is solved using Petrov-Galerkin weighting functions on the internal heat source and advective terms to correct for the under-diffusion and remove the oscillations which would result from the standard Galerkin method for an advection dominated problem 
\begin_inset LatexCommand \cite{Hughes and Brooks 1979}

\end_inset

. The Petrov-Galerkin function can be thought of as a standard Galerkin method in which we counterbalance the numerical underdiffusion by adding an artificial diffusivity of the form
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\left(\xi u_{\xi}h_{\xi}+\eta u_{\eta}h_{\eta}\right)/2\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

with
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\xi=1-\frac{2\kappa}{u_{\xi}h_{\xi}}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\eta=1-\frac{2\kappa}{u_{\eta}h_{\eta}}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

where 
\begin_inset Formula $h_{\xi}$
\end_inset

 and 
\begin_inset Formula $h_{\eta}$
\end_inset

 are the element lengths and 
\begin_inset Formula $u_{\xi}$
\end_inset

 and 
\begin_inset Formula $u_{\eta}$
\end_inset

 are the velocities in the local element coordinate system (
\begin_inset Formula $\xi$
\end_inset

 
\begin_inset Formula $\eta$
\end_inset

 system) evaluated at the element center. This form of discretization has no crosswind diffusion because the 
\begin_inset Quotes eld
\end_inset

artificial diffusion
\begin_inset Quotes erd
\end_inset

 acts only in the direction of the flow (i.e., it follows the streamline), hence the name Streamline Upwind Petrov-Galerkin (SUPG). This makes it a better approximation than straight upwinding, and it has been demonstrated to be more accurate than Galerkin or straight upwinding in advection dominated problems 
\begin_inset LatexCommand \cite{Hughes and Brooks 1979}

\end_inset

. It has recently been shown that the SUPG method is one of a broader class of methods for advection-diffusion equations referred to as Galerkin/Least-Squares methods 
\begin_inset LatexCommand \cite{Hughes et al 1988}

\end_inset

.
\end_layout

\begin_layout Standard

The resulting matrix equation is not symmetric, but since the energy equation only has one degree of freedom per node, while the momentum equation has two or three, the storage for the energy equation is small compared to the momentum equation. Since we use an explicit time stepping method, the energy equation is not implemented in matrix form. The added cost of calculating the Petrov-Galerkin weighting functions is much less than the cost of using a refined grid with the Galerkin method. The Galerkin method requires a finer grid then the Petrov-Galerkin method to achieve stable solutions 
\begin_inset LatexCommand \cite{Travis et al 1990}

\end_inset

. Time stepping in the energy equation is done using an explicit predictor-corrector algorithm. The form of the predictor-corrector algorithm is
\end_layout

\begin_layout Standard

Predict:
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
T_{n+1}^{\left(0\right)}=T_{n}+\Delta t\left(1-\alpha\right)\dot{T}_{n}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\dot{T}_{n=1}^{\left(0\right)}=0\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

Solve:
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
M^{*}\Delta\dot{T}_{n+1}^{\left(i\right)}=R_{n+1}^{\left(i\right)}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
R_{n+1}^{\left(i\right)}=-\left[\dot{T}_{n+1}^{\left(i\right)}+u\cdot\left(T_{n+1}^{\left(i\right)}\right),x\right]\left(w+p\right)-\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\tilde{k}w_{,x}\left(T_{n+1}^{\left(i\right)}\right),x+\,\,\,\left(boundary\, condition\, terms\right)\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

Correct:
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
T_{n+1}^{\left(i+1\right)}=T_{n+1}^{\left(i\right)}+\Delta t\alpha\dot{T}_{n+1}^{\left(i\right)}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\dot{T}_{n+1}^{\left(i+1\right)}=\dot{T}_{n+1}^{\left(i\right)}+\Delta\dot{T}_{n+1}^{\left(i\right)}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard
\noindent

where 
\begin_inset Formula $i$
\end_inset

 is the iteration number (for the corrector), 
\begin_inset Formula $n$
\end_inset

 is the time-step number, 
\begin_inset Formula $T$
\end_inset

 is the temperature, 
\begin_inset Formula $\dot{T}$
\end_inset

 is the derivative of temperature with time, 
\begin_inset Formula $\Delta\dot{T}$
\end_inset

 is the correction to the temperature derivative for the iteration, 
\begin_inset Formula $M^{*}$
\end_inset

 is the lumped mass matrix, 
\begin_inset Formula $R_{n+1}^{\left(i\right)}$
\end_inset

 is the residual term, 
\begin_inset Formula $\Delta t$
\end_inset

 is the time step and 
\begin_inset Formula $\alpha$
\end_inset

 is a convergence parameter. Note that in the explicit formulation 
\begin_inset Formula $M^{*}$
\end_inset

 is diagonal.
\end_layout

\begin_layout Standard

The time step is dynamically chosen, and corresponds to the Courant time step (the largest step that can be taken explicitly and maintain stability). With the appropriate choice of variables, 
\begin_inset Formula $\alpha$
\end_inset

 = 0.5 and two iterations, the method is second order accurate 
\begin_inset LatexCommand \cite[p. 562-566]{Hughes 1987}

\end_inset

.
\end_layout

\begin_layout Standard

The predict step is done in routine 
\series bold
timdrv
\series default
, the residual 
\begin_inset Formula $R$
\end_inset

 is formed in routine 
\series bold
f_tres
\series default
, 
\begin_inset Formula $M^{*}$
\end_inset

 is formed in routine 
\series bold
tmass
\series default
, and the correct step is also done in 
\series bold
f_tres
\series default
.
\end_layout

\begin_layout Chapter

Implementation
\end_layout

\begin_layout Section

Introduction
\end_layout

\begin_layout Standard

There are generally two phases to ConMan, input and time stepping. The main program is found in 
\series bold
ConMan.F
\series default
. The input is read in the files 
\series bold
input.F and elminp.F
\series default
. Time stepping is doing in 
\series bold
timdrv.F
\series default
. For legacy reasons, there is a rather complex structure of 
\series bold
eglib
\series default
 calling 
\series bold
eg2.F
\series default
 which calls the assembly and solve routines.
\end_layout

\begin_layout Standard

There are three significant differences that the user familiar with past versions of ConMan will find in this version. The original version of ConMan, distributed by King and/or Hager, was designed to take advantage of machines with vector registers, such as the Cray X-MP or Y-MP. Hence thoughout the code, operations that would be performed on an individual element on a scalar machine were grouped together so that they could be performed on a group of elements.
\end_layout

\begin_layout Standard

In this version of ConMan, the reordering of elements into blocks with independent degrees of freedom and the reorganization of routines into loops over element groups with inner do-loops having lengths equal to the length of vector registers has been removed. This means that the structure of the routines that form the element stiffness matrix (
\series bold
f_vstf.F
\series default
) and right-hand side, or residual, (
\series bold
f_vres.F
\series default
) for the Stokes equation, and the routines for the calculation of the right-hand side of the energy eqation (
\series bold
f_tmres.F
\series default
) are now loops over elements with short inner loops over local element nodes and/or integration points. One could argue that because modern CPU is relying on fast cache to keep the arithmatic units busy, the kind of grouping we did to take advantage of vector registers is still useful for modern processors. However, the element reordering made algorithms such as particle tracking (not implemented in this version) more challenging and was difficult for users new to the finite element method to understand. Therefore, we have removed the element reordering and block vectorization.
\end_layout

\begin_layout Standard

The second major change is that we have implemented a Picard iteration algorithm for steady-state problems (c.f. van Keken - thesis 
\series bold
[TODO: This sounds different from the van Keken bib entry we have now. What thesis?]
\series default
). Currently, this is implemented by changing compiler flags in the Makefile. Picard iteration is an implicit solution to the energy equation (as opposed to the predictor-corrector method described above); hence, non-symmetric factor and back-solve routines have been added as well as a routine to calculate the energy equation matrix and right-hand side vectors (
\series bold
f_trhsimp.F
\series default
). To use Picard iteration you change the variable 
\begin_inset Formula $\alpha$
\end_inset

 in the Time Sequence card (second line of the input file) from 0.5 to 1.0 and change the iterations from 2 to 1 (same line). You need to 
\begin_inset Quotes eld
\end_inset

make clean
\begin_inset Quotes erd
\end_inset

 and remake with the target Picard, to generate a new executable (conman.pic). A future revision may merge these energy equation solvers into a single code and hide the need to change the iteration steps from the user. When you have a steady-state solution, Picard iteration usually converges in 10-100 steps, as opposed to several thousand steps. When there is no steady-state solution, the Picard results are not useful and the explicit solver should be used.
\end_layout

\begin_layout Standard

The third significant change is the replacement of the 
\series bold
mpoint
\series default
 function which allocated memory in the blank common array `a' with the call 
\series bold
mmgetblk
\series default
. The `mm' routines are a fancy wrapper around a c 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 malloc
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 call. The reason for this change is fairly technical, and I will spare the user the details. The memory manager source can be found in the directory 
\family typewriter
mm.src
\family default
. Care has to be taken when compiling on 32-bit or 64-bit machines (change the header file in 
\family typewriter
mm.src
\family default
 from 
\family typewriter
mm2000_32.h
\family default
 to 
\family typewriter
mm2000_64.h
\family default
) and change the compile flags in the Makefile. It is now possible to use Fortran90's allocate routine for dynamic memory allocation, and the memory manager should be removed in a future revision. Making changes in the memory manager is tricky and this package is fragile. Users who have a problem with the memory manager should request assistance by contacting the CIG Mantle Convection Mailing List 
\begin_inset LatexCommand \url{cig-mc@geodynamics.org}

\end_inset

.
\end_layout

\begin_layout Section

Material Properties
\end_layout

\begin_layout Standard

As discussed above, the equations in dimensionless form have one dimensionless parameter, the Rayleigh number.
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
Ra=\frac{g\alpha\Delta Td^{3}}{\kappa\mu}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

where 
\begin_inset Formula $g$
\end_inset

 is the acceleration due to gravity, 
\begin_inset Formula $\alpha$
\end_inset

 is the coefficient of thermal expansion, 
\begin_inset Formula $\Delta T$
\end_inset

 is the temperature drop across the box, 
\begin_inset Formula $d$
\end_inset

 is the depth of the box, 
\begin_inset Formula $\kappa$
\end_inset

 is the thermal diffusivity, and 
\begin_inset Formula $\mu$
\end_inset

 is the dynamic viscosity. In ConMan, the input parameter is the buoyancy part of the Rayleigh number.
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
Ra_{buoy}=g\alpha\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

The depth, 
\begin_inset Formula $d$
\end_inset

, and the temperature difference, 
\begin_inset Formula $\Delta T$
\end_inset

 are specified from the grid and the temperature boundary conditions. 
\begin_inset Formula $\kappa$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are separate input parameters. If the depth, temperature difference, 
\begin_inset Formula $\kappa$
\end_inset

 and 
\begin_inset Formula $\mu$
\end_inset

 are set to 1, then the buoyancy number, 
\begin_inset Formula $RA_{buoy}$
\end_inset

, and the Rayleigh number, 
\begin_inset Formula $Ra$
\end_inset

, are the same.
\end_layout

\begin_layout Standard

The viscosity can be a function of temperature and/or depth. This is done in routine 
\series bold
rheol
\series default
. The user can easily modify the functional form for specific problems. The default functional form is
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
\mu\left(T,Z\right)=\mu_{o}\left\{ \exp\left\{ \frac{E^{*}*1.0e3+V^{*}z}{R*(T+T_{o})}\right\} -\exp\left\{ \frac{E^{*}*1.0e3+V^{*}z}{R*(1+T_{o})}\right\} \right\} \label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

where 
\begin_inset Formula $\mu_{o}$
\end_inset

 is the preexponential viscosity, 
\begin_inset Formula $E^{*}$
\end_inset

 is the activation energy, 
\begin_inset Formula $V^{*}$
\end_inset

 is the activation volume, 
\begin_inset Formula $T_{o}$
\end_inset

 is the temperature offset, 
\begin_inset Formula $T$
\end_inset

 is the temperature and 
\begin_inset Formula $z$
\end_inset

 is the depth. In the input files, 
\begin_inset Formula $\mu_{o}$
\end_inset

, is input on the viscosity card, 
\begin_inset Formula $E^{*}$
\end_inset

 is input as Tcon(1), 
\begin_inset Formula $V^{*}$
\end_inset

 is input as Tcon(2), and 
\begin_inset Formula $T_{o}$
\end_inset

 is hardwired in 
\series bold
rheol.newt.F
\series default
 to be 273. 
\begin_inset Formula $\Delta T$
\end_inset

 is hardwired to be 2000.0.
\end_layout

\begin_layout Standard

The scaling in 
\series bold
rheol.newt.F
\series default
 is such that 
\begin_inset Formula $E^{*}$
\end_inset

 can be input in kJ/mole and 
\begin_inset Formula $V^{*}$
\end_inset

 can be input as cm
\begin_inset Formula $^{3}$
\end_inset

.
\end_layout

\begin_layout Standard

Internal heating can be specified through the internal heating parameter. If no bottom temperature is specified, the Rayleigh number becomes
\end_layout

\begin_layout Standard


\begin_inset Formula \begin{equation}
Ra=\frac{g\alpha Hd^{5}}{k\kappa\mu}\label{eq:}\end{equation}
\end_inset


\end_layout

\begin_layout Standard

where 
\begin_inset Formula $H$
\end_inset

 is the internal heating parameter and 
\begin_inset Formula $k$
\end_inset

 is the thermal conductivity. The grid can have multiple material groups, each with its own set of material properties.
\end_layout

\begin_layout Section

Installation
\end_layout

\begin_layout Standard

ConMan comes ready to run with a Unicos makefile. The file 
\series bold
Makefile
\series default
 contains the system calls for the compiler and the loader, FC and LD respectively. These need to be changed for your machine. Also the calls to 
\series bold
second
\series default
, a Cray timing routine, will have to be changed in routine 
\series bold
timer
\series default
.
\end_layout

\begin_layout Section

Building from Source [TODO WEI -- thought you might need this section. Or else delete]
\end_layout

\begin_layout Subsection

System Requirements
\end_layout

\begin_layout Standard

ConMan works on a variety of computational platforms and has been tested on workstations running
\end_layout

\begin_layout Itemize

Mac OS X 10.4.6 (G4, G5, and Intel) 
\end_layout

\begin_layout Itemize

Windows 2000 and XP SP2 
\end_layout

\begin_layout Itemize

RedHat Fedora Core 5 (x86) 
\end_layout

\begin_layout Itemize

OpenSuse 10.0 (x86) 
\end_layout

\begin_layout Itemize

Gentoo (x86) 
\end_layout

\begin_layout Itemize

Debian stable (x86 and AMD64), testing (x86), and unstable (x86) 
\end_layout

\begin_layout Standard

ConMan has also been tested on clusters running Redhat 7.2 (x86) and RedHat Enterprise Linux 3 (EM64T).
\end_layout

\begin_layout Subsection

Dependencies
\end_layout

\begin_layout Standard

This version of ConMan is self-contained and requires no external libraries.
\end_layout

\begin_layout Subsection


\begin_inset LatexCommand \label{sec:Downloading-the-Code}

\end_inset

Downloading the Code
\end_layout

\begin_layout Standard

You can get the source for the latest release from the ConMan web page 
\begin_inset LatexCommand \url{geodynamics.org/cig/software/packages/mc/conman/}

\end_inset

. In that tarball is the file ???name???.
\end_layout

\begin_layout Subsubsection

Source Code Repository (Experts Only)
\end_layout

\begin_layout Standard

Advanced users and software developers may be interested in downloading the latest ConMan source code directly from the CIG source code repository, instead of using the prepared source package. To check whether you have a subversion client installed on your machine, type:
\end_layout

\begin_layout LyX-Code

svn
\end_layout

\begin_layout Standard

You should get a response that looks something like this:
\end_layout

\begin_layout LyX-Code

Type `svn help' for usage.
\end_layout

\begin_layout Standard

Otherwise, you will need to download and install a Subversion client, available at the Subversion Website 
\begin_inset LatexCommand \url{subversion.tigris.org/project_packages.html}

\end_inset

. Then the code can be checked out with the following command:
\end_layout

\begin_layout LyX-Code

svn checkout http://geodynamics.org/svn/cig/mc/3D/ConMan/trunk ConMan
\end_layout

\begin_layout Section


\begin_inset LatexCommand \label{sec:Support}

\end_inset

Support
\end_layout

\begin_layout Standard

The primary point of support for ConMan is the CIG Mantle Convection Mailing List 
\begin_inset LatexCommand \url{cig-mc@geodynamics.org}

\end_inset

. Feel free to send questions, comments, feature requests, and bugs to the list. The mailing list is archived at
\end_layout

\begin_layout LyX-Code

cig-mc Archives 
\begin_inset LatexCommand \url{geodynamics.org/pipermail/cig-mc/}

\end_inset


\end_layout

\begin_layout Standard

You may also use the bug tracker
\end_layout

\begin_layout LyX-Code

Roundup 
\begin_inset LatexCommand \url{geodynamics.org/roundup}

\end_inset


\end_layout

\begin_layout Standard

to submit bugs and requests for new features.
\end_layout

\begin_layout Chapter


\begin_inset LatexCommand \label{cha:Input-Guide}

\end_inset

Input Guide
\end_layout

\begin_layout Standard

To run ConMan a series of nine file names are needed, some for input and some for output. Usually these are read from a runfile. The first two files are input files 
\series bold
input
\series default
 and 
\series bold
geom
\series default
 and are described in this section. The third file is an output file showing all the input parameters in a verbose form. The fourth and fifth files are an input temperature file (optional) and an output temperature file. These are for starting a new run from a previous run. The sixth file is a time series file (see routine 
\series bold
fluxke
\series default
), the seventh file is the coordinates, velocities and temperatures, the eighth file is for stresses (see routine 
\series bold
stress.F
\series default
) and the ninth file is for geoid and topography (see routine 
\series bold
geoid.F
\series default
). These file names are read in routine 
\series bold
ConMan.F
\series default
.
\end_layout

\begin_layout Standard

The input for ConMan is read from two different FORTRAN units. The first unit, 
\series bold
iin
\series default
, contains the time stepping, output, and material parameters as well as element type information while the second unit, 
\series bold
igeom
\series default
, contains the coordinates, boundary values and connectivity information. ConMan reads the file names to attach to these units from standard input. The typical way to run ConMan is to create a file with nine lines, one file name per line, and redirect this into the executable (i.e., % conman.pic < runfile & ). 
\series bold
iin
\series default
 is attached to the file named on the first line and 
\series bold
igeom
\series default
 is attached to the file named on the second line (names must be ASCII with a length less than 80 characters long).
\end_layout

\begin_layout Standard

The input deck was broken up so that an automatic grid generating routine could be used to generate coordinates, boundary conditions and element connectivities separate from ConMan. The only automatic grid generation ConMan does is linear or bilinear interpolation which is described in the appropriate sections of this guide.
\end_layout

\begin_layout Standard

The following sixteen cards or groups of cards are read from the 
\series bold
iin
\series default
 unit (throughout this guide a 
\begin_inset Quotes eld
\end_inset

card
\begin_inset Quotes erd
\end_inset

 will mean one line of an ASCII text file). These constitute the parameter part of the input 
\begin_inset Quotes eld
\end_inset

deck
\begin_inset Quotes erd
\end_inset

 for the program ConMan. The format for this guide is a 
\series bold
bold
\series default
 title line giving the card title followed by an 
\emph on
italicized
\emph default
 line showing the order of the parameters and a listing of the parameters (with a brief explanation).
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Title\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
Any descriptive character string up to 80 characters long
\emph default
 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Global\InsetSpace ~
Constants\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
numnp nsd ndof nelx nelz mprec iflow necho inrsts iorstr nodebn ntimvs ntseq numeg isky nwrap
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numnp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . total number of nodal points 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nsd
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . number of spatial dimensions (always 2) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ndof
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of degrees of freedom (always 2) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nelx
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of elements in the x1 (horizontal) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nelz
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of elements in the x2 (vertical) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

mprec
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . precision flag (always use double)
\end_layout

\begin_deeper
\begin_layout Standard

1 - single
\end_layout

\begin_layout Standard

2 - double
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

iflow
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . data check flag
\end_layout

\begin_deeper
\begin_layout Standard

0 - check data only
\end_layout

\begin_layout Standard

1 - execute code
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

necho
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . echo data flag
\end_layout

\begin_deeper
\begin_layout Standard

0 - minimum data echo (terse)
\end_layout

\begin_layout Standard

1 - echo data to output file (verbose)
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inrstr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . read restart file flag
\end_layout

\begin_deeper
\begin_layout Standard

0 - use default start (conductive)
\end_layout

\begin_layout Standard

1 - read restart file from unit 16
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

iorstr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . write restart file flag
\end_layout

\begin_deeper
\begin_layout Standard

0 - don
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
textquoteright
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

t write restart file
\end_layout

\begin_layout Standard

1 - write restart file to unit 17
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nodebn
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . number of edge nodes for nusselt smoother 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ntimvs
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . temperature dependent viscosity flag
\end_layout

\begin_deeper
\begin_layout Standard

0 - stiffness matrix factored once
\end_layout

\begin_layout Standard

1 - stiffness matrix factored every time step
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ntseq
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of time sequences (always 1)
\end_layout

\begin_deeper
\begin_layout Standard

currently only one supported
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numeg
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . number of element groups (always 1)
\end_layout

\begin_deeper
\begin_layout Standard

currently only one supported
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

isky
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . flag for skyline factor
\end_layout

\begin_deeper
\begin_layout Standard

0 - regular skyline
\end_layout

\begin_layout Standard

1 - vectorized skyline
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nwrap
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . number of nodes to wrap
\end_layout

\begin_deeper
\begin_layout Standard

equal to number of elements in vertical
\end_layout

\begin_layout Standard

to use nodes must be numbered increasing
\end_layout

\begin_layout Standard

fastest in vertical direction
\end_layout

\end_deeper
\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Time\InsetSpace ~
Sequence\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - ntseq cards
\end_layout

\begin_deeper
\begin_layout Standard


\emph on
nstep niter alpha delt epstol
\emph default

\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nstep
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of time steps 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

niter
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of multicorrector iterations
\end_layout

\begin_deeper
\begin_layout Standard

2 - second-order expicit
\end_layout

\begin_layout Standard

1 - picard
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

alpha
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . multicorrector parameter
\end_layout

\begin_deeper
\begin_layout Standard

0.5 for explicit 2nd order
\end_layout

\begin_layout Standard

1.0 for picard
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

delt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . time step (not used) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

epstol
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . tolerance for hybrid method (not used) 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Output\InsetSpace ~
Step\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
nsdprt nsvprt nstprt nsmprt
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nsdprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . steps between disk output 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nsvprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . steps between velocity output (not used) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nstprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . steps between temperature, velocity & stress output 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nsmprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . steps between stress field output (not used) 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Velocity\InsetSpace ~
Boundary\InsetSpace ~
Condition\InsetSpace ~
Flag\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
bnode enode incr (bcf(i), i=1,ndof)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bnode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . beginning node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

enode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . ending node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node increment 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bcf(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . boundary condition flag for ith degree of freedom
\end_layout

\begin_deeper
\begin_layout Standard

0 - free slip
\end_layout

\begin_layout Standard

1 - pinned degree of freedom
\end_layout

\end_deeper
\end_deeper
\begin_layout Standard


\emph on
0 0 0 0 0 to end VBCF cards
\emph default

\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Temperature\InsetSpace ~
Boundary\InsetSpace ~
Condition\InsetSpace ~
Flag\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
bnode enode incr bcf
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bnode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . beginning node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

enode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . ending node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node increment 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bcf
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . boundary condition flag for temperature
\end_layout

\begin_deeper
\begin_layout Standard

1- fixed temperature
\end_layout

\end_deeper
\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 0 to end TBCF cards
\emph default

\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Nusselt\InsetSpace ~
Number\InsetSpace ~
Boundary\InsetSpace ~
Condition\InsetSpace ~
Flag\InsetSpace ~
Cards\InsetSpace ~
-\InsetSpace ~
Edge\InsetSpace ~
Nodes
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 top and bottom rows of nodes 
\emph on
bnode enode incr
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bnode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . beginning node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

enode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . ending node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node increment 
\end_layout

\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 to end NNBCF (type a) cards
\emph default

\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Nusselt\InsetSpace ~
Number\InsetSpace ~
Boundary\InsetSpace ~
Condition\InsetSpace ~
Flag\InsetSpace ~
Cards\InsetSpace ~
-\InsetSpace ~
Second\InsetSpace ~
Row\InsetSpace ~
Nodes
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 second from top and bottom rows of nodes 
\emph on
bnode enode incr
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

bnode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . beginning node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

enode
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . ending node 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node increment 
\end_layout

\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 to end NNBCF (type b) cards
\emph default

\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Initial\InsetSpace ~
Temperature\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
pert xsize zsize
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

pert
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . perturbation from conductive state 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

xsize
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . nondimensional length (x1 direction) of box 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

zsize
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . nondimensional height (x2 direction) of box 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Element\InsetSpace ~
Parameter\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - numeg cards 
\emph on
ntype numel nen nenl numat nedof numsuf nipt implv implt
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ntype
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . element type
\end_layout

\begin_deeper
\begin_layout Standard

2 - two dimensional elements
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numel
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . total number of elements 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nen
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . number of element nodes (always 4) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nenl
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of local element nodes (always 4) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numat
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . number of material groups 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nedof
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of element degrees of freedom (always 2) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numsuf
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . number of imposed stress/flux cards 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nipt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of integration points per element (always 5) 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

implv
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . currently unused 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

implt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . currently unused 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Viscosity\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
visc(i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

visc(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . preexponential viscosity coefficient for ith element 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Penalty\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
alam(i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

alam(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . penalty parameter for ith element 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Diffusivity\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
diff(i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

diff(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . thermal diffusivity for ith element 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Buoyancy\InsetSpace ~
Rayleigh\InsetSpace ~
Number\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
Ra(i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Ra(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . bouyancy part of Rayleigh number for ith element 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Internal\InsetSpace ~
Heating\InsetSpace ~
Parameter\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
dmhu(i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

dmhu(i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . internal heat source for ith material group 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Activation\InsetSpace ~
Energy\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
tcon(1,i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

tcon(1,i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . activation energy for ith material group for temperature dependent viscosity (kJ/mole) 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Activation\InsetSpace ~
Volume\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
tcon(2,i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

tcon(2,i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . activation volume for ith material group for temperature dependent viscosity (cm
\begin_inset Formula $^{3}$
\end_inset

/mole) 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Viscosity\InsetSpace ~
Cutoff\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
tcon(3,i), i=1,numat
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

tcon(3,i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . maximum value of the viscosity for the ith material group 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Surface\InsetSpace ~
Force/Flux\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - numsuf cards 
\emph on
nel side fnorm ftan flux
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nel
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . element number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

side
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . side to apply force and flux
\end_layout

\begin_deeper
\begin_layout Standard

1 - bottom
\end_layout

\begin_layout Standard

2 - right side
\end_layout

\begin_layout Standard

3 - top
\end_layout

\begin_layout Standard

4 - left side
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

fnorm
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . normal surface force 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ftan
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . tangential surface force 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

flux
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . heat flux 
\end_layout

\end_deeper
\begin_layout Standard

The following four groups of cards are read from the 
\series bold
igeom
\series default
 unit. These constitute the geometry part of the input 
\begin_inset Quotes eld
\end_inset

deck
\begin_inset Quotes erd
\end_inset

 for the program 
\family typewriter
conman
\family default
. The format of this section is the same as above.
\end_layout

\begin_layout Section

Coordinate Group 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Absolute\InsetSpace ~
Coordinate\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
node gp (x(i,node) i=1,nsd)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . the node whose coordinates are to be specified 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

gp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . generation parameter for automatic generation
\end_layout

\begin_deeper
\begin_layout Standard

0 - no autogeneration
\end_layout

\begin_layout Standard

2 - generate a line using node as a starting point
\end_layout

\begin_layout Standard

4 - generate a box using node as the lower left corner
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

x(i,node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . coordinate value in the ith spatial dimension 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Corner\InsetSpace ~
Generation\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - gp-1 cards 
\emph on
node mgen (x(i,node) i=1,nsd)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

mgen
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . generation parameter
\end_layout

\begin_deeper
\begin_layout Standard

0 - don
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
textquoteright
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

t use this as the start of a generation sequence
\end_layout

\begin_layout Standard

1 - use this as the start of a generation sequence
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

x(i,node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . coordinate value in the ith spatial dimension 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Generation\InsetSpace ~
Increment\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
ninc1 inc1 ninc2 inc2
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x2 direction
\end_layout

\begin_deeper
\begin_layout Standard

0 - if gp equals 2
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x2 direction
\end_layout

\begin_deeper
\begin_layout Standard

0 - if gp equals 2
\end_layout

\end_deeper
\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 0 to end coordinate group
\emph default

\end_layout

\end_deeper
\begin_layout Section

Velocity Boundary Condition Group 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Absolute\InsetSpace ~
Velocity\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
node gp (v(i,node) i=1,nsd)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . the node whose velocities are to be specified 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

gp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . generation parameter for automatic generation
\end_layout

\begin_deeper
\begin_layout Standard

0 - no autogeneration
\end_layout

\begin_layout Standard

2 - generate a line using node as a starting point
\end_layout

\begin_layout Standard

4 - generate a box using node as the lower left corner
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

v(i,node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . velocity value in the ith spatial dimension 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Corner\InsetSpace ~
Generation\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - gp-1 cards 
\emph on
node mgen (v(i,node) i=1,nsd)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

mgen
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . generation parameter
\end_layout

\begin_deeper
\begin_layout Standard

0 - don
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
textquoteright
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

t use this as the start of a generation sequence
\end_layout

\begin_layout Standard

1 - use this as the start of a generation sequence
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

v(i,node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . velocity value in the ith spatial dimension 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Generation\InsetSpace ~
Increment\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
ninc1 inc1 ninc2 inc2
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x2 direction
\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

0
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - if gp equals 2 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x2 direction
\end_layout

\begin_deeper
\begin_layout Standard

0 - if gp equals 2
\end_layout

\end_deeper
\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 0 to end velocity group
\emph default

\end_layout

\end_deeper
\begin_layout Section

Temperature Boundary Condition Group 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Absolute\InsetSpace ~
Temperature\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
node gp t(node)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . the node whose velocities are to be specified 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

gp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . generation parameter for automatic generation
\end_layout

\begin_deeper
\begin_layout Standard

0 - no autogeneration
\end_layout

\begin_layout Standard

2 - generate a line using node as a starting point
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

t(node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . temperature value 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Corner\InsetSpace ~
Generation\InsetSpace ~
Cards
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 - gp-1 cards 
\emph on
node mgen t(node)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

node
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . node number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

mgen
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . generation parameter
\end_layout

\begin_deeper
\begin_layout Standard

0 - don
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
textquoteright
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{}
\end_layout

\end_inset

t use this as the start of a generation sequence
\end_layout

\begin_layout Standard

1 - use this as the start of a generation sequence
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

t(node)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . temperature value 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Generation\InsetSpace ~
Increment\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
ninc1 inc1 ninc2 inc2
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x1 direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ninc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of additional nodes to generate in x2 direction
\end_layout

\begin_deeper
\begin_layout Standard

0 - if gp equals 2
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

inc2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x2 direction
\end_layout

\begin_deeper
\begin_layout Standard

0 - if gp equals 2
\end_layout

\end_deeper
\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 to end temperature group
\emph default

\end_layout

\end_deeper
\begin_layout Section

Element Connectivity (ien) Generation Group 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Absolution\InsetSpace ~
Element\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
elnu ng mat no (ien(elnu,i) i=1,nen)
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

elnu
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . element number 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ng
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . . generation parameter
\end_layout

\begin_deeper
\begin_layout Standard

0 - no generation
\end_layout

\begin_layout Standard

1 - generate using increments from increment card
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

mat
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 no . . . . . . material number for this element 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

ien(elnu,i)
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . global node number for the ith local node of element counterclockwise from lower left corner 
\end_layout

\end_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

Increment\InsetSpace ~
Card
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 
\emph on
nel1 incel1 incn1 nel2 incel2 incn2
\emph default

\end_layout

\begin_deeper
\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nel1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of elements in x1 (horizontal) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incel1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of elements in x1 (horizontal) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incn1
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x1 (horizontal) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

nel2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . number of elements in x2 (vertical) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incel2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of elements in x2 (vertical) direction 
\end_layout

\begin_layout Description


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

incn2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 . . . . . . . increment of nodes in x2 (vertical) direction 
\end_layout

\end_deeper
\begin_deeper
\begin_layout Standard


\emph on
0 0 0 0 0 0 to end element connectivity group
\emph default

\end_layout

\end_deeper
\begin_layout Chapter


\begin_inset LatexCommand \label{cha:Sample-Input-Files}

\end_inset

Sample Input Files 
\end_layout

\begin_layout Standard

The lines below are a sample 50 element by 50 element input deck for a 1 by 1 square, constant viscosity with the Picard method. This is Blankenbach 1a
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{verbatim}
\end_layout

\end_inset

 50 x 50 el. problem for Blankenbach Benchmark numnp nsd ndof nelx nelz prc ck iecho rrst wrst nus tdvf tseq nelg sky wr 2601 2 2 50 50 2 1 0 0 1 102 0 1 1 1 0 time step information 100 1 1.0 1.0 0.50000 output information 100 100 100 100 velocity boundary condition flags bnode enode incr bcf1 bcf2 1 2551 51 0 1 2551 2601 1 1 0 1 51 1 1 0 51 2601 51 0 1 1 1 1 1 1 51 51 1 1 1 2551 2551 1 1 1 2601 2601 1 1 1 0 0 0 0 0 temperature boundary condition flags 1 2551 51 1 51 2601 51 1 0 0 0 0 bndy info (top - bottom rows) 1 2551 51 51 2601 51 0 0 0 bndy info (2nd from top - 2nd from bottom rows) 2 2552 51 50 2600 51 0 0 0 initial condition information 0.1 1.0 1.0 1.0 element information 2 2500 4 4 1 2 0 5 0 0 viscosity 1.0e0 penalty number 0.1E+08 diffusivity (always one) 1.0 Rayleigh number 1.0e+04 internal heating parameter 0.0 activation energy 0.0 activation volume 0.0 viscosity cutoff 1.0e7 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{verbatim}
\end_layout

\end_inset

 The lines below are a sample geometry file for the 50 by 50 element problem.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{verbatim}
\end_layout

\end_inset

 coordinates 1 4 0.0 0.0 2551 1 1.0 0.0 2601 1 1.0 1.0 51 1 0.0 1.0 50 51 50 1 0 0 0.0 0.0 velocity boundary conditions (non-zero) 0 0 0.0 0.0 temperature boundary conditions (non-zero) 1 2 1.0 2551 0 1.0 50 51 0 0 0.0 element connectivity and material groups 1 1 1 1 52 53 2 50 50 51 50 1 1 0 0 0 0 0 0 0 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter


\begin_inset LatexCommand \label{cha:Output-Guide}

\end_inset

Output Guide
\end_layout

\begin_layout Section

The Output Files
\end_layout

\begin_layout Standard

The output files names are taken from the names in the runfile. The execution of 
\family typewriter
conman
\family default
 proceeds by % conman.pic < runfile where the runfile has a list of filenames that can be up to 80 characters long.
\end_layout

\begin_layout Standard
\noindent

The names in the runfile are attached to the following input or output files.
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
begin{verbatim}
\end_layout

\end_inset

 input geometry output restart input restart output time series output temperature (and velocity) field output stress (and viscosity) field output geoid output 
\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
end{verbatim}
\end_layout

\end_inset


\end_layout

\begin_layout Standard

All files are ASCII files. The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 input
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 and 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 geometry
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 files are as described in the previous section.
\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is a formatted record of the input. If the variable 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 necho
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 is set to one, then values of the coordinates and boundary conditions are output and the file can become large. Near the end of the 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file execution time is listed for various subparts of the code.
\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 restart input
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is an input file that is used if the variable 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 inrstr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 is set to one. The file is ASCII but formatted and the format statement can be found in the file 
\series bold
input.F
\series default
. The first line contains the initial timestep and time, the second line is a header, and the third through 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 numnp
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 lines contains the node, temperature and time derivative of temperature.
\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 restart output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is an output file that is used if the variable 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 iorstr
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 is set to one. We recommend this always be set to run. This file is overwritten every 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nsdprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 steps and the output is written from the file 
\series bold
timdrv.F
\series default

\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 time series output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is written every time step. The values are ASCII and are heat flux at the bottom, heat flux at the top, kinetic energy, and time. All values are dimensionless. This file is written from the routine 
\series bold
fluxke.F
\series default

\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 Temperature and velocity output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is an ASCII file written from the routine 
\series bold
print.F
\series default
. There are two header lines that contain 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nsd, nelx, nelz, numnp, nstep, time
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

. The second line labels the output and the third through numnp lines list the node, x, z, vx, vz, and temperature values at each node. This file is output every 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nsvprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 steps and each successive set of values is appended to the end of the file. The unix command 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 split -
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numnp+2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 tempfile
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 can be used to split the file into files that are 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 numnp+2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 lines long.
\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 Stress output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file is an ASCII file written from the routine 
\series bold
prtstr
\series default
 which can be found in the file 
\series bold
stress.F
\series default
. Like the temperature velocity file there are two header lines that contain 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nsd, nelx, nelz, numnp, nstep, time
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

. The second line labels the output and the third through 
\family typewriter
numnp
\family default
 lines list the node, x, z, txx, tzz. txz. p and viscosity at each node. This file is output every 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nsvprt
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 steps and each successive set of values is appended to the end of the file. The unix command 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 split -
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset

numnp+2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 tempfile
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 can be used to split the file into files that are 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 numnp+2
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 lines long.
\end_layout

\begin_layout Standard

The 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 geoid output
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

 file contains the horizontal coordinate, the dynamic topography, the geoid contribution from the temperature only and the total geoid (from surface and cmb topography, and internal (i.e., temperature) density contrasts). This is written from the file 
\series bold
geoid.F
\series default
. The dimensional values are hard wired into the code and can be found at the top of 
\series bold
geoid.F
\series default
. This version of the geoid code has not been tested with flow-through boundary conditions (i.e, 
\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 nwrap = nelz
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset

).
\end_layout

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard

{
\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
em
\end_layout

\end_inset

 
\series bold

\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
textcolor{red}{
\end_layout

\end_inset

Warning.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\series default
 As written, the code assumes a Rayleigh number of 
\begin_inset Formula $10^{7}$
\end_inset

 and does not adjust the parameters as the Rayleigh number changes. This would be a trivial fix but still may not yield the results intended. It is best to carefully check the 
\series bold
geoid.F
\series default
 source for the specific problem if interest.
\begin_inset ERT
status collapsed

\begin_layout Standard

}
\end_layout

\end_inset


\end_layout

\begin_layout Chapter


\begin_inset LatexCommand \label{cha:The-Benchmark-Cases}

\end_inset

The Benchmark Cases
\end_layout

\begin_layout Standard

We provide input and geometry files for the benchmark cases described below in the directories 
\family typewriter
cookbook1
\family default
 and 
\family typewriter
cookbook2
\family default
.
\end_layout

\begin_layout Section

Cookbook 1: Constant Viscosity Benchmark for ConMan
\end_layout

\begin_layout Standard

Here we reproduce the results from Blankenbach et al. (1989) 
\series bold
[TODO need reference for bibliography]
\series default
 for constant viscosity in a unit-aspect ratio domain, with free-slip boundary conditions, heated from below and cooled from above. The user should note that to run this problem, you will need to modify the routines 
\series bold
rheol.newt.F
\series default
 and 
\series bold
geoid.F
\series default
 following the comments in those routines. The constant viscosity calculations (1a, 1b, and 1c) use a Rayleigh number of 
\begin_inset Formula $10^{4}$
\end_inset

, 
\begin_inset Formula $10^{5}$
\end_inset

, and 
\begin_inset Formula $10^{6}$
\end_inset

 respectively and the dimensional parameters are listed in Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Mantle-parameters-for}

\end_inset

. The time is the runtime in seconds for the Picard version of the code using 100 iterations on an intel MacPro with two 3\InsetSpace ~
GHz processors using the Intel fortran compiler with -O2 optimization. While the problems in Blankenbach et al. are specified dimensionally, the equations are solved non-dimensionally within ConMan for numerical stability and the scaling factors are applied to the results.
\end_layout

\begin_layout Standard

The results are computed on uniformly spaced grids and the global properties of Nusselt number and root-mean-square velocity, as well as the topography and geoid at the left- and right-hand side of the domain are reported, along with the extrapolated value from Christensen's results (see Blankenbach et al., 1989 for discussion) in Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Blankenbach-(1989)-Benchmark-1a}

\end_inset

 (Rayleigh number 
\begin_inset Formula $10^{4}$
\end_inset

), Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Blankenbach-(1989)-Benchmark-1b}

\end_inset

 (Rayleigh number 
\begin_inset Formula $10^{5}$
\end_inset

), and Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Blankenbach-(1989)-Benchmark-1c}

\end_inset

 (Rayleigh number 
\begin_inset Formula $10^{6}$
\end_inset

). For the global properties of Nusselt number and root-mean-square velocity, the 50 by 50 element grid are within 1% of Christensen's extrapolated results even for the Rayleigh number 
\begin_inset Formula $10^{6}$
\end_inset

 calculations. The agreement for the point values of topography and geoid are also 1% error on the 50 by 50 grid for the topography and geoid for the 50 by 50 element grid for the Rayleigh number 
\begin_inset Formula $10^{6}$
\end_inset

 calculations (Table\InsetSpace ~
7.4). For the 200 by 200 grid, all values converge to Christensen's extrapolated results.
\end_layout

\begin_layout Standard


\begin_inset Float table
placement htdp
wide false
sideways false
status open


\begin_layout Standard

 
\end_layout

\begin_layout Standard
\align center


\begin_inset Tabular 
<lyxtabular version="3" rows="11" columns="4">
<features>
<column alignment="left" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<row topline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Parameter
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Symbol
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Value
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="left" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

depth of domain 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $d$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $10^{6}$
\end_inset

\InsetSpace ~
m 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" topline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

gravitational acceleration 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

g 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10 m/s
\begin_inset Formula $^{2}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

temperature difference 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $\Delta T$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1000 K 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

density 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $\rho$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

4000\InsetSpace ~
kg m
\begin_inset Formula $^{-3}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

thermal diffusivity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $\kappa$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $1.0\times10^{-6}$
\end_inset

 m
\begin_inset Formula $^{2}$
\end_inset

 s
\begin_inset Formula $^{-1}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

coefficient of thermal expansion 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $\alpha$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $2.5\times10^{-5}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

kinematic viscosity 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $\eta$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $2.5\times10^{19}$
\end_inset

 Pa s (1a) 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $2.5\times10^{18}$
\end_inset

 Pa s (1b) 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row>
<cell alignment="left" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $2.5\times10^{17}$
\end_inset

 Pa s (1c) 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
<row bottomline="true">
<cell alignment="left" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

gravitational constant 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $G$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset Formula $6.673\times10^{-11}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="none" valignment="top" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Caption


\begin_inset LatexCommand \label{tab:Mantle-parameters-for}

\end_inset

Mantle parameters for Blankenbach constant viscosity benchmarks.
\end_layout

\begin_layout Standard


\begin_inset LatexCommand \label{default}

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Float table
wide false
sideways false
status open


\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="6" columns="8">
<features>
<column alignment="right" valignment="top" leftline="true">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top" rightline="true">
<row topline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="|c">
\begin_inset Text

\begin_layout Standard

Grid
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

V
\begin_inset Formula $_{rms}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Nusselt No.
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c|">
\begin_inset Text

\begin_layout Standard

Run Time (sec)
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

50 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

42.906 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

4.887 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

2261.956 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-2911.473 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

55.346 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-63.178 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1.98 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

100 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

42.875 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

4.885 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

2256.094 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-2905.356 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

54.957 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-62.765 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

18.04 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

200 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

42.867 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

4.885 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

2254.541 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-2903.763 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

54.856 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-62.658 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

187.43 
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 C
\begin_inset Formula $_{ext}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

42.865 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

4.884 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

2254.021 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-2903.221 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

54.822 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-62.622 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row topline="true" bottomline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" bottomline="true" usebox="none" special="|l|">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 Christensen's extrapolated values.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Caption


\begin_inset LatexCommand \label{tab:Blankenbach-(1989)-Benchmark-1a}

\end_inset

Blankenbach (1989) Benchmark 1a: Steady State, 2D, constant viscosity convection in a 1 by 1 box with Rayleigh number 
\begin_inset Formula $10^{4}$
\end_inset

 using ConMan.
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Float table
wide false
sideways false
status open


\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="6" columns="8">
<features>
<column alignment="right" valignment="top" leftline="true">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top" rightline="true">
<row topline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="|c">
\begin_inset Text

\begin_layout Standard

Grid
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

V
\begin_inset Formula $_{rms}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Nusselt No.
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c|">
\begin_inset Text

\begin_layout Standard

Run Time (sec)
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

50 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

193.592 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

10.546 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1482.778 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-2014.228 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

28.846 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-33.104 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1.82 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

100 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

193.297 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10.539 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1467.169 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-2008.138 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

28.034 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-32.327 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

17.66 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

200 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

193.248 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10.536 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1462.487 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-2005.473 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

27.789 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-32.099 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

185.22 
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 C
\begin_inset Formula $_{ext}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

193.214 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

10.534 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1460.986 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-2004.205 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

27.703 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-32.016 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row topline="true" bottomline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" bottomline="true" usebox="none" special="|l|">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 Christensen's extrapolated values.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Caption


\begin_inset LatexCommand \label{tab:Blankenbach-(1989)-Benchmark-1b}

\end_inset

Blankenbach (1989) Benchmark 1b: Steady State, 2D, constant viscosity convection in a 1 by 1 box with Rayleigh number 
\begin_inset Formula $10^{5}$
\end_inset

 using ConMan.
\end_layout

\end_inset


\end_layout

\begin_layout Standard


\begin_inset Float table
wide false
sideways false
status open


\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="6" columns="8">
<features>
<column alignment="right" valignment="top" leftline="true">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top" rightline="true">
<row topline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="|c">
\begin_inset Text

\begin_layout Standard

Grid
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

V
\begin_inset Formula $_{rms}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Nusselt No.
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c|">
\begin_inset Text

\begin_layout Standard

Run Time (sec)
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

50 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

840.524 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

21.864 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

941.607 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-1301.980 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

14.958 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-16.678 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1.71 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

100 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

835.606 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

22.023 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

945.108 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-1290.926 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

14.109 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-15.632 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

17.38 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

200 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

834.353 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

21.981 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

936.439 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-1285.756 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

13.654 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-15.204 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

184.27 
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 C
\begin_inset Formula $_{ext}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

833.989 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

21.997 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

931.962 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-1283.813 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

13.452 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-15.034 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row topline="true" bottomline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" bottomline="true" usebox="none" special="|l|">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 Christensen's extrapolated values.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Caption


\begin_inset LatexCommand \label{tab:Blankenbach-(1989)-Benchmark-1c}

\end_inset

Blankenbach (1989) Benchmark 1c: Steady State, 2D, constant viscosity convection in a 1 by 1 box with Rayleigh number 
\begin_inset Formula $10^{6}$
\end_inset

 using ConMan.
\end_layout

\end_inset


\end_layout

\begin_layout Section

Cookbook 2: Temperature-Dependent Viscosity Benchmark for ConMan
\end_layout

\begin_layout Standard

Here we reproduce the results from Blankenbach et al. (1989) for temperature-dependent viscosity in a unit-aspect ratio domain, with free-slip boundary conditions, heated from below and cooled from above (case 2a). For this problem, the temperature-dependence of viscosity is given by 
\begin_inset Formula \begin{equation}
\eta(T)=\eta_{o}\exp\left[{-\ln\{1000\}}\frac{{T}}{{\Delta T}}\right]\end{equation}
\end_inset

 where 
\begin_inset Formula $\eta_{o}=2.9\times10^{19}$
\end_inset

 and 
\begin_inset Formula $\Delta T=1000.0$
\end_inset

. The other scaling parameters are the same as Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Mantle-parameters-for}

\end_inset

. The results for a Rayleigh number of 
\begin_inset Formula $10^{4}$
\end_inset

 are presented in Table\InsetSpace ~

\begin_inset LatexCommand \ref{tab:Blankenbach-(1989)-Benchmark-2a}

\end_inset

. Here once again the global properties of Nusselt number and root-mean-square velocity for the 50 by 50 grid are within 1-2% of Christensen's extrapolated results; however, in contrast to the constant viscosity cases, the values of topography and geoid in the corners differ from Christensen's extrapolated results by as much as 3% for topography and 7% for geoid on the 50 element by 50 element grid. Again, by the 400x400 grid, the values are well within 0.5%.
\end_layout

\begin_layout Standard


\begin_inset Float table
wide false
sideways false
status open


\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
centering
\end_layout

\end_inset

 
\begin_inset Tabular 
<lyxtabular version="3" rows="7" columns="8">
<features>
<column alignment="right" valignment="top" leftline="true">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="center" valignment="top">
<column alignment="right" valignment="top" rightline="true">
<row topline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="|c">
\begin_inset Text

\begin_layout Standard

Grid
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

V
\begin_inset Formula $_{rms}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Nusselt No.
\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Topo
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{L}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c">
\begin_inset Text

\begin_layout Standard

Geoid
\begin_inset Formula $_{R}$
\end_inset


\end_layout

\end_inset
</cell>
<cell multicolumn="1" alignment="none" valignment="top" topline="true" usebox="none" special="c|">
\begin_inset Text

\begin_layout Standard

Run Time (sec)
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

50 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

488.950 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

10.080 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1041.464 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-4012.790 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

18.584 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-55.084 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

6.17 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

100 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

482.583 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10.070 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1017.502 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-4081.259 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

17.657 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-54.790 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

60.85 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

200 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

480.879 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10.067 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1012.217 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-4094.520 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

17.417 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-54.654 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

739.20 
\end_layout

\end_inset
</cell>
</row>
<row>
<cell alignment="right" valignment="top" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

400 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

480.493 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

10.066 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

1011.109 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-4097.093 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

17.360 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" usebox="none">
\begin_inset Text

\begin_layout Standard

-54.610 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

10826.89 
\end_layout

\end_inset
</cell>
</row>
<row topline="true">
<cell alignment="right" valignment="top" topline="true" leftline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 C
\begin_inset Formula $_{ext}$
\end_inset

 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

480.433 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

10.066 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

1010.925 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-4098.073 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

17.343 
\end_layout

\end_inset
</cell>
<cell alignment="center" valignment="top" topline="true" usebox="none">
\begin_inset Text

\begin_layout Standard

-54.598 
\end_layout

\end_inset
</cell>
<cell alignment="right" valignment="top" topline="true" rightline="true" usebox="none">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
null
\end_layout

\end_inset

 
\end_layout

\end_inset
</cell>
</row>
<row topline="true" bottomline="true">
<cell multicolumn="1" alignment="none" valignment="top" topline="true" bottomline="true" usebox="none" special="|l|">
\begin_inset Text

\begin_layout Standard


\begin_inset ERT
status collapsed

\begin_layout Standard


\backslash
dag
\end_layout

\end_inset

 Christensen's extrapolated values.
\end_layout

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
<cell multicolumn="2" alignment="center" valignment="top" topline="true" bottomline="true" usebox="none">
\begin_inset Text

\end_inset
</cell>
</row>
</lyxtabular>

\end_inset


\end_layout

\begin_layout Caption


\begin_inset LatexCommand \label{tab:Blankenbach-(1989)-Benchmark-2a}

\end_inset

Blankenbach (1989) Benchmark 2a: Steady State, 2D, temperature-dependent viscosity convection (b=6.907755279) in a 1 by 1 box with Rayleigh number 
\begin_inset Formula $10^{4}$
\end_inset

 using ConMan.
\end_layout

\end_inset


\end_layout

\begin_layout Section

Cookbook 3: Constant Viscosity Driven Slab Problem for ConMan
\end_layout

\begin_layout Standard

This geometry is based on the subduction zone benchmark by 
\begin_inset LatexCommand \cite{van Keken et al 2008}

\end_inset

. A thermal structure from this is presented on the cover. The purpose here is to illustrate how one can (with some struggle) implement a deformed and variable mesh with the fairly basic grid generator in ConMan. One can use a more advanced grid generator and input the coordinates of every node directly as well as the 
\series bold
ien
\series default
 array for each element.
\end_layout

\begin_layout Standard

This problem will not reproduce the exact result presented in 
\begin_inset LatexCommand \cite{van Keken et al 2008}

\end_inset

 because this version of ConMan does not have the discontinuous velocity field, which turns out to be critical to match the benchmark results. The resulting thermal structure should look like Figure\InsetSpace ~

\begin_inset LatexCommand \ref{fig:wedge}

\end_inset

.
\end_layout

\begin_layout Standard
\noindent
\align center


\begin_inset Float figure
wide false
sideways false
status open


\begin_layout Caption


\begin_inset LatexCommand \label{fig:wedge}

\end_inset

 Thermal structure for the wedge problem in Cookbook 3 example.
\end_layout

\begin_layout Standard
\align center


\begin_inset Graphics 
	filename images/wedge.pdf
	scale 60

\end_inset

 
\end_layout

\end_inset


\end_layout

\begin_layout Standard
\start_of_appendix


\begin_inset ERT
status collapsed

\begin_layout Standard

%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\begin_inset ERT
status collapsed

\begin_layout Standard

%dummy comment inserted by tex2lyx to ensure that this paragraph is not empty
\end_layout

\begin_layout Standard


\end_layout

\end_inset


\end_layout

\begin_layout Chapter

License 
\end_layout

\begin_layout Standard


\series bold
GNU GENERAL PUBLIC LICENSE Version 2, June 1991. Copyright (C) 1989, 1991 Free Software Foundation, Inc. 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA
\series default
 
\newline
 Everyone is permitted to copy and distribute verbatim copies of this license document, but changing it is not allowed.
\end_layout

\begin_layout Section*

Preamble
\end_layout

\begin_layout Standard

The licenses for most software are designed to take away your freedom to share and change it. By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software -- to make sure the software is free for all its users. This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it. (Some other Free Software Foundation software is covered by the GNU Library General Public License instead.) You can apply it to your programs, too.
\end_layout

\begin_layout Standard

When we speak of free software, we are referring to freedom, not price. Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.
\end_layout

\begin_layout Standard

To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.
\end_layout

\begin_layout Standard

For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have. You must make sure that they, too, receive or can get the source code. And you must show them these terms so they know their rights.
\end_layout

\begin_layout Standard

We protect your rights with two steps:
\end_layout

\begin_layout Enumerate

Copyright the software, and 
\end_layout

\begin_layout Enumerate

Offer you this license which gives you legal permission to copy, distribute and/or modify the software. 
\end_layout

\begin_layout Standard

Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software. If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.
\end_layout

\begin_layout Standard

Finally, any free program is threatened constantly by software patents. We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary. To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.
\end_layout

\begin_layout Standard

The precise terms and conditions for copying, distribution and modification follow.
\end_layout

\begin_layout Section*

GNU GENERAL PUBLIC LICENSE TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION 
\end_layout

\begin_layout Itemize


\begin_inset ERT
status collapsed

\begin_layout Standard

[
\end_layout

\end_inset

0.
\begin_inset ERT
status collapsed

\begin_layout Standard

]
\end_layout

\end_inset

This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License. The "Program" below refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language. (Hereinafter, translation is included without limitation in the term "modification.") Each licensee is addressed as "you."
\newline
 
\newline
 Activities other than copying, distribution and modification are not covered by this License; they are outside its scope. The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does. 
\end_layout

\begin_layout Enumerate

You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.
\end_layout

\begin_deeper
\begin_layout Standard

You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.
\end_layout

\end_deeper
\begin_layout Enumerate

You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:
\end_layout

\begin_deeper
\begin_layout Enumerate

You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change. 
\end_layout

\begin_layout Enumerate

You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License. 
\end_layout

\begin_layout Enumerate

If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License. (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.) 
\end_layout

\end_deeper
\begin_deeper
\begin_layout Standard

These requirements apply to the modified work as a whole. If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works. But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.
\end_layout

\begin_layout Standard

Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.
\end_layout

\begin_layout Standard

In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.
\end_layout

\end_deeper
\begin_layout Enumerate

You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:
\end_layout

\begin_deeper
\begin_layout Enumerate

Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or, 
\end_layout

\begin_layout Enumerate

Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or, 
\end_layout

\begin_layout Enumerate

Accompany it with the information you received as to the offer to distribute corresponding source code. (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.) 
\end_layout

\end_deeper
\begin_deeper
\begin_layout Standard

The source code for a work means the preferred form of the work for making modifications to it. For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable. However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.
\end_layout

\begin_layout Standard

If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.
\end_layout

\end_deeper
\begin_layout Enumerate

You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License. Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance. 
\end_layout

\begin_layout Enumerate

You are not required to accept this License, since you have not signed it. However, nothing else grants you permission to modify or distribute the Program or its derivative works. These actions are prohibited by law if you do not accept this License. Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it. 
\end_layout

\begin_layout Enumerate

Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions. You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License. 
\end_layout

\begin_layout Enumerate

If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License. If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all. For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.
\end_layout

\begin_deeper
\begin_layout Standard

If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.
\end_layout

\begin_layout Standard

It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices. Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.
\end_layout

\begin_layout Standard

This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.
\end_layout

\end_deeper
\begin_layout Enumerate

If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded. In such case, this License incorporates the limitation as if written in the body of this License. 
\end_layout

\begin_layout Enumerate

The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time. Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
\end_layout

\begin_deeper
\begin_layout Standard

Each version is given a distinguishing version number. If the Program specifies a version number of this License which applies to it and "any later version," you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation. If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.
\end_layout

\end_deeper
\begin_layout Enumerate

If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission. For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this. Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally. 
\end_layout

\begin_layout Subsection*

NO WARRANTY 
\end_layout

\begin_layout Itemize


\begin_inset ERT
status collapsed

\begin_layout Standard

[
\end_layout

\end_inset

11.
\begin_inset ERT
status collapsed

\begin_layout Standard

]
\end_layout

\end_inset

BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW. EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE. THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU. SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION. 
\end_layout

\begin_layout Itemize


\begin_inset ERT
status collapsed

\begin_layout Standard

[
\end_layout

\end_inset

12.
\begin_inset ERT
status collapsed

\begin_layout Standard

]
\end_layout

\end_inset

IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES. 
\end_layout

\begin_layout Section*

END OF TERMS AND CONDITIONS 
\end_layout

\begin_layout Subsection*

How to Apply These Terms to Your New Programs
\end_layout

\begin_layout Standard

If you develop a new program, and you want it to be of the greatest possible use to the public, the best way to achieve this is to make it free software which everyone can redistribute and change under these terms.
\end_layout

\begin_layout Standard

To do so, attach the following notices to the program. It is safest to attach them to the start of each source file to most effectively convey the exclusion of warranty; and each file should have at least the "copyright" line and a pointer to where the full notice is found. For example:
\end_layout

\begin_layout Quote

One line to give the program's name and a brief idea of what it does. Copyright 
\size footnotesize
© (
\size normal
year) (name of author)
\end_layout

\begin_layout Quote

This program is free software; you can redistribute it and/or modify it under the terms of the GNU General Public License as published by the Free Software Foundation; either version 2 of the License, or (at your option) any later version.
\end_layout

\begin_layout Quote

This program is distributed in the hope that it will be useful, but WITHOUT ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE. See the GNU General Public License for more details.
\end_layout

\begin_layout Quote

You should have received a copy of the GNU General Public License along with this program; if not, write to the Free Software Foundation, Inc., 59 Temple Place, Suite 330, Boston, MA 02111-1307 USA 
\end_layout

\begin_layout Standard

Also add information on how to contact you by electronic and paper mail.
\end_layout

\begin_layout Standard

If the program is interactive, make it output a short notice like this when it starts in an interactive mode:
\end_layout

\begin_layout Quote

Gnomovision version 69, Copyright © year name of author Gnomovision comes with ABSOLUTELY NO WARRANTY; for details type `show w'. This is free software, and you are welcome to redistribute it under certain conditions; type `show c' for details. 
\end_layout

\begin_layout Standard

The hypothetical commands `show w' and `show c' should show the appropriate parts of the General Public License. Of course, the commands you use may be called something other than `show w' and `show c'; they could even be mouse-clicks or menu items -- whatever suits your program.
\end_layout

\begin_layout Standard

You should also get your employer (if you work as a programmer) or your school, if any, to sign a "copyright disclaimer" for the program, if necessary. Here is a sample; alter the names:
\end_layout

\begin_layout Quote

Yoyodyne, Inc., hereby disclaims all copyright interest in the program `Gnomovision' (which makes passes at compilers) written by James Hacker.
\end_layout

\begin_layout Quote

(signature of Ty Coon)
\newline
 1 April 1989 
\newline
 Ty Coon, President of Vice 
\end_layout

\begin_layout Standard

This General Public License does not permit incorporating your program into proprietary programs. If your program is a subroutine library, you may consider it more useful to permit linking proprietary applications with the library. If this is what you want to do, use the GNU Library General Public License instead of this License.
\end_layout

\begin_layout Bibliography

\bibitem [1]{Blankenbach et al, 1989}
Blankenbach, B., F. Busse, U. Christensen, L. Cserepes, D. Gunkel, U. Hansen, H. Harder, G. Jarvis, M. Koch, G. Marquart, D. Moore, P. Olson, H. Schmeling and T. Schnaubelt (1989) A Benchmark comparison for mantle convection codes, 
\emph on
Geophys. J. Int.
\emph default
, 98, 23-38.
\end_layout

\begin_layout Bibliography

\bibitem [2]{Brooks 1981}
Brooks, A.N. 
\emph on
A Petrov-Galerkin finite-element formulation for convection dominated flows.
\emph default
 Unpublished doctoral thesis, California Institute of Technology, Pasadena, CA, 1981.
\end_layout

\begin_layout Bibliography

\bibitem [3]{Brooks and Hughes 1990}
Brooks, A.N. and Hughes, T.J.R. (1990), Streamline upwind/Petrov-Galerkin formulations for convection dominated flows with particular emphasis on the incompressible Navier-Stokes equations. 
\emph on
Comp. Meth. in Appl. Mech. and Eng., 81(3),
\emph default
 199-259.
\end_layout

\begin_layout Bibliography

\bibitem [4]{Hughes 1987}
Hughes, T.J.R. 
\emph on
The finite element method.
\emph default
 Prentice-Hall, Inc., Englewood Cliffs, New Jersey, 1987.
\end_layout

\begin_layout Bibliography

\bibitem [5]{Hughes and Brooks 1979}
Hughes, T.J.R. and Brooks, A.N. (1979), A multi-dimensional upwind scheme with no crosswind diffusion. In: Finite element methods for convection dominated flows (T.J.R. Hughes, ed.), 
\emph on
ASME,
\emph default
 
\emph on
34
\emph default
, 19-35.
\end_layout

\begin_layout Bibliography

\bibitem [6]{Hughes et al 1988}
Hughes, T.J.R., Franca, L.P., Hulbert, G.M., Johan, Z., and Shakib, F. (1988), The Galerkin/least-squares method for advective-diffusive equations, in 
\emph on
Recent developments in computational fluid dynamics
\emph default
 (T.E. Tezduyar, ed.), 
\emph on
ASME,
\emph default
 
\emph on
95
\emph default
, 75-99.
\end_layout

\begin_layout Bibliography

\bibitem [7]{Hughes et al 1979}
Hughes, T.J.R., Liu, W.K., and Brooks, A.N. (1979), Finite element analysis of incompressible viscous flows by the penalty function formulation. 
\emph on
J. Comput. Phys.,
\emph default
 
\emph on
30
\emph default
, 1-60.
\end_layout

\begin_layout Bibliography

\bibitem [8]{Malkus and Hughes 1978}
Malkus, D.S. and Hughes, T.J.R. (1978), Mixed finite element methods reduced and selective integration techniques: a unification of concepts. 
\emph on
Comp. Meth. in Appl. Mech. and Eng.,
\emph default
 
\emph on
15
\emph default
, 63-81.
\end_layout

\begin_layout Bibliography

\bibitem [9]{Temam 1977}
Temam, R. 
\emph on
Navier-Stokes equations: theory and numerical analysis
\emph default
. North-Holland. Amsterdam, 1977.
\end_layout

\begin_layout Bibliography

\bibitem [10]{Travis et al 1990}
Travis, B.J., Anderson, C., Baumgardner, J., Gable, C.W., Hager, B.H., O'Connell, R.J., Olson, P., Raefsky, A. and Schubert, G. (1990), A benchmark comparison of numerical methods for infinite Prandtl number convection in two-dimensional Cartesian geometry, 
\emph on
Geophys. Astrophys. Fluid Dynamics,
\emph default
 
\emph on
55
\emph default
, 137-160, doi: 10.1080/03091929008204111
\end_layout

\begin_layout Bibliography

\bibitem [11]{van Keken 1993}
van Keken, P. E. (1993) Numerical modeling of thermochemically driven fluid flow with non-Newtonian rheology: Applied to the Earth's lithosphere and mantle, Ph.D. Thesis, Utrecht University.
\end_layout

\begin_layout Bibliography

\bibitem [12]{van Keken et al 2008}
 van Keken, P.E., Currie, C., King, S.D., Behn, M.D., Canioncle, A., He, J., Katz, R.F., Lin, S.-C., Parmentier, E.M., Spiegelman, M., and Wang, K. (2008), A community benchmark for subduction zone modeling, 
\emph on
Phys. Earth Planet. Int.
\emph default
, in press. 
\end_layout

\end_body
\end_document
